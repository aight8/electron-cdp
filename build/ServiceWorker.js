"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EventEmitter = require("events");
const DebuggerError_1 = require("./DebuggerError");
/**
 * No description
 * @experimental
 */
class ServiceWorker {
    constructor(dbg /* Electron.Debugger*/) {
        this.dbg = dbg; /* Electron.Debugger*/
        this.events = new EventEmitter();
        this.dbg.on('message', (event, method, params) => {
            const [domain, domainMethod] = method.split('.');
            this.events.emit(domainMethod, params);
        });
        if (!this.dbg.isAttached()) {
            throw new Error(`Cannot create ServiceWorker Domain Class because the debugger is not attached.`);
        }
    }
    on(event, listener) {
        this.events.on(event, listener);
    }
    once(event, listener) {
        this.events.on(event, listener);
    }
    assertError(error, commandName) {
        if ('message' in error && 'code' in error) {
            throw new DebuggerError_1.default(error.message, error.code, commandName);
        }
    }
    /** No description */
    async enable() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.enable', {}, (error, result) => {
                this.assertError(error, 'ServiceWorker.enable');
                resolve();
            });
        });
    }
    /** No description */
    async disable() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.disable', {}, (error, result) => {
                this.assertError(error, 'ServiceWorker.disable');
                resolve();
            });
        });
    }
    /** No description */
    async unregister(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.unregister', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.unregister');
                resolve();
            });
        });
    }
    /** No description */
    async updateRegistration(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.updateRegistration', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.updateRegistration');
                resolve();
            });
        });
    }
    /** No description */
    async startWorker(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.startWorker', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.startWorker');
                resolve();
            });
        });
    }
    /** No description */
    async skipWaiting(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.skipWaiting', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.skipWaiting');
                resolve();
            });
        });
    }
    /** No description */
    async stopWorker(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.stopWorker', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.stopWorker');
                resolve();
            });
        });
    }
    /** No description */
    async inspectWorker(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.inspectWorker', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.inspectWorker');
                resolve();
            });
        });
    }
    /** No description */
    async setForceUpdateOnPageLoad(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.setForceUpdateOnPageLoad', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.setForceUpdateOnPageLoad');
                resolve();
            });
        });
    }
    /** No description */
    async deliverPushMessage(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.deliverPushMessage', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.deliverPushMessage');
                resolve();
            });
        });
    }
    /** No description */
    async dispatchSyncEvent(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('ServiceWorker.dispatchSyncEvent', params, (error, result) => {
                this.assertError(error, 'ServiceWorker.dispatchSyncEvent');
                resolve();
            });
        });
    }
}
exports.default = ServiceWorker;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VydmljZVdvcmtlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL2dlbmVyYXRlZC10cy9TZXJ2aWNlV29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQXNDO0FBQ3RDLG1EQUEyQztBQTJOM0M7OztHQUdHO0FBQ0g7SUFHSSxZQUE2QixHQUFRLENBQUMsc0JBQXNCO1FBQS9CLFFBQUcsR0FBSCxHQUFHLENBQUssQ0FBQyxzQkFBc0I7UUFGcEQsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUE7UUFJL0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBVSxFQUFFLE1BQVcsRUFBRSxNQUFXO1lBQ3hELE1BQU0sQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtZQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDMUMsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3pCLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0ZBQWdGLENBQUMsQ0FBQTtRQUNyRyxDQUFDO0lBQ0wsQ0FBQztJQUVNLEVBQUUsQ0FBQyxLQUFhLEVBQUUsUUFBa0I7UUFDdkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFTSxJQUFJLENBQUMsS0FBYSxFQUFFLFFBQWtCO1FBQ3pDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0lBRU8sV0FBVyxDQUFDLEtBQVUsRUFBRSxXQUFtQjtRQUMvQyxFQUFFLENBQUMsQ0FBQyxT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QUFFLE1BQU0sRUFBRSxDQUFDLEtBQVUsRUFBRSxNQUFXO2dCQUMzRixJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSx3Q0FBd0MsQ0FBQyxDQUFBO2dCQUNqRSxPQUFPLEVBQUUsQ0FBQTtZQUNiLENBQUMsQ0FBQyxDQUFBO1FBQ04sQ0FBQyxDQUFDLENBQUE7SUFDTixDQUFDO0lBRUQscUJBQXFCO0lBQ2QsS0FBSyxDQUFDLGtCQUFrQixDQUFDLE1BQStDO1FBQzNFLE1BQU0sQ0FBQyxNQUFNLElBQUksT0FBTyxDQUFZLENBQUMsT0FBTyxFQUFFLE1BQU07WUFDaEQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsa0NBQWtDLEVBQUUsTUFBTSxFQUFFLENBQUMsS0FBVSxFQUFFLE1BQVc7Z0JBQ3JGLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLGtDQUFrQyxDQUFDLENBQUE7Z0JBQzNELE9BQU8sRUFBRSxDQUFBO1lBQ2IsQ0FBQyxDQUFDLENBQUE7UUFDTixDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFFRCxxQkFBcUI7SUFDZCxLQUFLLENBQUMsaUJBQWlCLENBQUMsTUFBOEM7UUFDekUsTUFBTSxDQUFDLE1BQU0sSUFBSSxPQUFPLENBQVksQ0FBQyxPQUFPLEVBQUUsTUFBTTtZQUNoRCxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxpQ0FBaUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxLQUFVLEVBQUUsTUFBVztnQkFDcEYsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsaUNBQWlDLENBQUMsQ0FBQTtnQkFDMUQsT0FBTyxFQUFFLENBQUE7WUFDYixDQUFDLENBQUMsQ0FBQTtRQUNOLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztDQUVKO0FBRUQsa0JBQWUsYUFBYSxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50cydcbmltcG9ydCBEZWJ1Z2dlckVycm9yIGZyb20gJy4vRGVidWdnZXJFcnJvcidcbmltcG9ydCBUYXJnZXQgZnJvbSAnLi9UYXJnZXQnXG5cbmRlY2xhcmUgaW50ZXJmYWNlIFNlcnZpY2VXb3JrZXIge1xuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgb24oZXZlbnQ6ICd3b3JrZXJSZWdpc3RyYXRpb25VcGRhdGVkJywgbGlzdGVuZXI6IChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuRXZlbnRQYXJhbXMud29ya2VyUmVnaXN0cmF0aW9uVXBkYXRlZCkgPT4gdm9pZCk6IHZvaWRcbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBvbmNlKGV2ZW50OiAnd29ya2VyUmVnaXN0cmF0aW9uVXBkYXRlZCcsIGxpc3RlbmVyOiAocGFyYW1zOiBTZXJ2aWNlV29ya2VyLkV2ZW50UGFyYW1zLndvcmtlclJlZ2lzdHJhdGlvblVwZGF0ZWQpID0+IHZvaWQpOiB2b2lkXG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBvbihldmVudDogJ3dvcmtlclZlcnNpb25VcGRhdGVkJywgbGlzdGVuZXI6IChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuRXZlbnRQYXJhbXMud29ya2VyVmVyc2lvblVwZGF0ZWQpID0+IHZvaWQpOiB2b2lkXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgb25jZShldmVudDogJ3dvcmtlclZlcnNpb25VcGRhdGVkJywgbGlzdGVuZXI6IChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuRXZlbnRQYXJhbXMud29ya2VyVmVyc2lvblVwZGF0ZWQpID0+IHZvaWQpOiB2b2lkXG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBvbihldmVudDogJ3dvcmtlckVycm9yUmVwb3J0ZWQnLCBsaXN0ZW5lcjogKHBhcmFtczogU2VydmljZVdvcmtlci5FdmVudFBhcmFtcy53b3JrZXJFcnJvclJlcG9ydGVkKSA9PiB2b2lkKTogdm9pZFxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIG9uY2UoZXZlbnQ6ICd3b3JrZXJFcnJvclJlcG9ydGVkJywgbGlzdGVuZXI6IChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuRXZlbnRQYXJhbXMud29ya2VyRXJyb3JSZXBvcnRlZCkgPT4gdm9pZCk6IHZvaWRcblxufVxuXG5tb2R1bGUgU2VydmljZVdvcmtlciB7XG4gICAgLyoqKioqKioqKioqKioqKlxuICAgICAqKioqIFR5cGVzICoqKipcbiAgICAgKioqKioqKioqKioqKiovXG5cbiAgICAvKipcbiAgICAgKiBTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbi5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgZXhwb3J0IHR5cGUgU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbiA9IHtcbiAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgIHJlZ2lzdHJhdGlvbklkOiBzdHJpbmdcblxuICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgc2NvcGVVUkw6IHN0cmluZ1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICBpc0RlbGV0ZWQ6IGJvb2xlYW5cbiAgICB9XG5cbiAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgIGV4cG9ydCB0eXBlIFNlcnZpY2VXb3JrZXJWZXJzaW9uUnVubmluZ1N0YXR1cyA9ICdzdG9wcGVkJyB8ICdzdGFydGluZycgfCAncnVubmluZycgfCAnc3RvcHBpbmcnXG5cbiAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgIGV4cG9ydCB0eXBlIFNlcnZpY2VXb3JrZXJWZXJzaW9uU3RhdHVzID0gJ25ldycgfCAnaW5zdGFsbGluZycgfCAnaW5zdGFsbGVkJyB8ICdhY3RpdmF0aW5nJyB8ICdhY3RpdmF0ZWQnIHwgJ3JlZHVuZGFudCdcblxuICAgIC8qKlxuICAgICAqIFNlcnZpY2VXb3JrZXIgdmVyc2lvbi5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgZXhwb3J0IHR5cGUgU2VydmljZVdvcmtlclZlcnNpb24gPSB7XG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICB2ZXJzaW9uSWQ6IHN0cmluZ1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICByZWdpc3RyYXRpb25JZDogc3RyaW5nXG5cbiAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgIHNjcmlwdFVSTDogc3RyaW5nXG5cbiAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgIHJ1bm5pbmdTdGF0dXM6IFNlcnZpY2VXb3JrZXJWZXJzaW9uUnVubmluZ1N0YXR1c1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICBzdGF0dXM6IFNlcnZpY2VXb3JrZXJWZXJzaW9uU3RhdHVzXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBMYXN0LU1vZGlmaWVkIGhlYWRlciB2YWx1ZSBvZiB0aGUgbWFpbiBzY3JpcHQuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgc2NyaXB0TGFzdE1vZGlmaWVkPzogbnVtYmVyXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW1lIGF0IHdoaWNoIHRoZSByZXNwb25zZSBoZWFkZXJzIG9mIHRoZSBtYWluIHNjcmlwdCB3ZXJlIHJlY2VpdmVkIGZyb20gdGhlIHNlcnZlci4gIEZvciBjYWNoZWQgc2NyaXB0IGl0IGlzIHRoZSBsYXN0IHRpbWUgdGhlIGNhY2hlIGVudHJ5IHdhcyB2YWxpZGF0ZWQuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgc2NyaXB0UmVzcG9uc2VUaW1lPzogbnVtYmVyXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5vIGRlc2NyaXB0aW9uXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgY29udHJvbGxlZENsaWVudHM/OiBUYXJnZXQuVGFyZ2V0SURbXVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBObyBkZXNjcmlwdGlvblxuICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICovXG4gICAgICAgIHRhcmdldElkPzogVGFyZ2V0LlRhcmdldElEXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VydmljZVdvcmtlciBlcnJvciBtZXNzYWdlLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBTZXJ2aWNlV29ya2VyRXJyb3JNZXNzYWdlID0ge1xuICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgZXJyb3JNZXNzYWdlOiBzdHJpbmdcblxuICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgcmVnaXN0cmF0aW9uSWQ6IHN0cmluZ1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICB2ZXJzaW9uSWQ6IHN0cmluZ1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICBzb3VyY2VVUkw6IHN0cmluZ1xuXG4gICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXJcblxuICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgY29sdW1uTnVtYmVyOiBudW1iZXJcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqKioqIENvbW1hbmQgUGFyYW1ldGVycyAqKioqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBleHBvcnQgbW9kdWxlIFBhcmFtcyB7XG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHVucmVnaXN0ZXIgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIHNjb3BlVVJMOiBzdHJpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHVwZGF0ZVJlZ2lzdHJhdGlvbiA9IHtcbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgc2NvcGVVUkw6IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgc3RhcnRXb3JrZXIgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIHNjb3BlVVJMOiBzdHJpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNraXBXYWl0aW5nID0ge1xuICAgICAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgICAgICBzY29wZVVSTDogc3RyaW5nXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzdG9wV29ya2VyID0ge1xuICAgICAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgICAgICB2ZXJzaW9uSWQ6IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgaW5zcGVjdFdvcmtlciA9IHtcbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgdmVyc2lvbklkOiBzdHJpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNldEZvcmNlVXBkYXRlT25QYWdlTG9hZCA9IHtcbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgZm9yY2VVcGRhdGVPblBhZ2VMb2FkOiBib29sZWFuXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBkZWxpdmVyUHVzaE1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIG9yaWdpbjogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgcmVnaXN0cmF0aW9uSWQ6IHN0cmluZ1xuXG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIGRhdGE6IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgZGlzcGF0Y2hTeW5jRXZlbnQgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIG9yaWdpbjogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgcmVnaXN0cmF0aW9uSWQ6IHN0cmluZ1xuXG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIHRhZzogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgbGFzdENoYW5jZTogYm9vbGVhblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqKioqIENvbW1hbmQgUmVzdWx0ICoqKipcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBFdmVudCBQYXJhbWV0ZXJzICoqKipcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBleHBvcnQgbW9kdWxlIEV2ZW50UGFyYW1zIHtcbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgd29ya2VyUmVnaXN0cmF0aW9uVXBkYXRlZCA9IHtcbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgcmVnaXN0cmF0aW9uczogU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbltdXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSB3b3JrZXJWZXJzaW9uVXBkYXRlZCA9IHtcbiAgICAgICAgICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAgICAgdmVyc2lvbnM6IFNlcnZpY2VXb3JrZXJWZXJzaW9uW11cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHdvcmtlckVycm9yUmVwb3J0ZWQgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogU2VydmljZVdvcmtlckVycm9yTWVzc2FnZVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIE5vIGRlc2NyaXB0aW9uXG4gKiBAZXhwZXJpbWVudGFsXG4gKi9cbmNsYXNzIFNlcnZpY2VXb3JrZXIge1xuICAgIHByaXZhdGUgZXZlbnRzID0gbmV3IEV2ZW50RW1pdHRlcigpXG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGRiZzogYW55IC8qIEVsZWN0cm9uLkRlYnVnZ2VyKi8gKSB7XG5cbiAgICAgICAgdGhpcy5kYmcub24oJ21lc3NhZ2UnLCAoZXZlbnQ6IGFueSwgbWV0aG9kOiBhbnksIHBhcmFtczogYW55KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbZG9tYWluLCBkb21haW5NZXRob2RdID0gbWV0aG9kLnNwbGl0KCcuJylcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzLmVtaXQoZG9tYWluTWV0aG9kLCBwYXJhbXMpXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCF0aGlzLmRiZy5pc0F0dGFjaGVkKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNyZWF0ZSBTZXJ2aWNlV29ya2VyIERvbWFpbiBDbGFzcyBiZWNhdXNlIHRoZSBkZWJ1Z2dlciBpcyBub3QgYXR0YWNoZWQuYClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBvbihldmVudDogc3RyaW5nLCBsaXN0ZW5lcjogRnVuY3Rpb24pIHtcbiAgICAgICAgdGhpcy5ldmVudHMub24oZXZlbnQsIGxpc3RlbmVyKVxuICAgIH1cblxuICAgIHB1YmxpYyBvbmNlKGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3NlcnRFcnJvcihlcnJvcjogYW55LCBjb21tYW5kTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICgnbWVzc2FnZScgaW4gZXJyb3IgJiYgJ2NvZGUnIGluIGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRGVidWdnZXJFcnJvcihlcnJvci5tZXNzYWdlLCBlcnJvci5jb2RlLCBjb21tYW5kTmFtZSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIHB1YmxpYyBhc3luYyBlbmFibGUoKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5lbmFibGUnLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1NlcnZpY2VXb3JrZXIuZW5hYmxlJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIGRpc2FibGUoKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5kaXNhYmxlJywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdTZXJ2aWNlV29ya2VyLmRpc2FibGUnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBwdWJsaWMgYXN5bmMgdW5yZWdpc3RlcihwYXJhbXM6IFNlcnZpY2VXb3JrZXIuUGFyYW1zLnVucmVnaXN0ZXIpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdTZXJ2aWNlV29ya2VyLnVucmVnaXN0ZXInLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdTZXJ2aWNlV29ya2VyLnVucmVnaXN0ZXInKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBwdWJsaWMgYXN5bmMgdXBkYXRlUmVnaXN0cmF0aW9uKHBhcmFtczogU2VydmljZVdvcmtlci5QYXJhbXMudXBkYXRlUmVnaXN0cmF0aW9uKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci51cGRhdGVSZWdpc3RyYXRpb24nLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdTZXJ2aWNlV29ya2VyLnVwZGF0ZVJlZ2lzdHJhdGlvbicpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIHB1YmxpYyBhc3luYyBzdGFydFdvcmtlcihwYXJhbXM6IFNlcnZpY2VXb3JrZXIuUGFyYW1zLnN0YXJ0V29ya2VyKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5zdGFydFdvcmtlcicsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1NlcnZpY2VXb3JrZXIuc3RhcnRXb3JrZXInKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBwdWJsaWMgYXN5bmMgc2tpcFdhaXRpbmcocGFyYW1zOiBTZXJ2aWNlV29ya2VyLlBhcmFtcy5za2lwV2FpdGluZyk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1NlcnZpY2VXb3JrZXIuc2tpcFdhaXRpbmcnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdTZXJ2aWNlV29ya2VyLnNraXBXYWl0aW5nJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIHN0b3BXb3JrZXIocGFyYW1zOiBTZXJ2aWNlV29ya2VyLlBhcmFtcy5zdG9wV29ya2VyKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5zdG9wV29ya2VyJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnU2VydmljZVdvcmtlci5zdG9wV29ya2VyJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIGluc3BlY3RXb3JrZXIocGFyYW1zOiBTZXJ2aWNlV29ya2VyLlBhcmFtcy5pbnNwZWN0V29ya2VyKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5pbnNwZWN0V29ya2VyJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnU2VydmljZVdvcmtlci5pbnNwZWN0V29ya2VyJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIHNldEZvcmNlVXBkYXRlT25QYWdlTG9hZChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuUGFyYW1zLnNldEZvcmNlVXBkYXRlT25QYWdlTG9hZCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1NlcnZpY2VXb3JrZXIuc2V0Rm9yY2VVcGRhdGVPblBhZ2VMb2FkJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnU2VydmljZVdvcmtlci5zZXRGb3JjZVVwZGF0ZU9uUGFnZUxvYWQnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBwdWJsaWMgYXN5bmMgZGVsaXZlclB1c2hNZXNzYWdlKHBhcmFtczogU2VydmljZVdvcmtlci5QYXJhbXMuZGVsaXZlclB1c2hNZXNzYWdlKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5kZWxpdmVyUHVzaE1lc3NhZ2UnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdTZXJ2aWNlV29ya2VyLmRlbGl2ZXJQdXNoTWVzc2FnZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIHB1YmxpYyBhc3luYyBkaXNwYXRjaFN5bmNFdmVudChwYXJhbXM6IFNlcnZpY2VXb3JrZXIuUGFyYW1zLmRpc3BhdGNoU3luY0V2ZW50KTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnU2VydmljZVdvcmtlci5kaXNwYXRjaFN5bmNFdmVudCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1NlcnZpY2VXb3JrZXIuZGlzcGF0Y2hTeW5jRXZlbnQnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VydmljZVdvcmtlciJdfQ==