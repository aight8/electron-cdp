"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EventEmitter = require("events");
const DebuggerError_1 = require("./DebuggerError");
/**
 * DOM debugging allows setting breakpoints on particular DOM operations and events. JavaScript execution will stop on these operations as if there was a regular breakpoint set.
 */
class DOMDebugger {
    constructor(dbg /* Electron.Debugger*/) {
        this.dbg = dbg; /* Electron.Debugger*/
        this.events = new EventEmitter();
        if (!this.dbg.isAttached()) {
            throw new Error(`Cannot create DOMDebugger Domain Class because the debugger is not attached.`);
        }
    }
    on(event, listener) {
        this.events.on(event, listener);
    }
    once(event, listener) {
        this.events.on(event, listener);
    }
    assertError(error, commandName) {
        if ('message' in error && 'code' in error) {
            throw new DebuggerError_1.default(error.message, error.code, commandName);
        }
    }
    /** Sets breakpoint on particular operation with DOM. */
    async setDOMBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.setDOMBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.setDOMBreakpoint');
                resolve();
            });
        });
    }
    /** Removes DOM breakpoint that was set using <code>setDOMBreakpoint</code>. */
    async removeDOMBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.removeDOMBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.removeDOMBreakpoint');
                resolve();
            });
        });
    }
    /** Sets breakpoint on particular DOM event. */
    async setEventListenerBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.setEventListenerBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.setEventListenerBreakpoint');
                resolve();
            });
        });
    }
    /** Removes breakpoint on particular DOM event. */
    async removeEventListenerBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.removeEventListenerBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.removeEventListenerBreakpoint');
                resolve();
            });
        });
    }
    /**
     * Sets breakpoint on particular native event.
     * @experimental
     */
    async setInstrumentationBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.setInstrumentationBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.setInstrumentationBreakpoint');
                resolve();
            });
        });
    }
    /**
     * Removes breakpoint on particular native event.
     * @experimental
     */
    async removeInstrumentationBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.removeInstrumentationBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.removeInstrumentationBreakpoint');
                resolve();
            });
        });
    }
    /** Sets breakpoint on XMLHttpRequest. */
    async setXHRBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.setXHRBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.setXHRBreakpoint');
                resolve();
            });
        });
    }
    /** Removes breakpoint from XMLHttpRequest. */
    async removeXHRBreakpoint(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.removeXHRBreakpoint', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.removeXHRBreakpoint');
                resolve();
            });
        });
    }
    /**
     * Returns event listeners of the given object.
     * @experimental
     */
    async getEventListeners(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('DOMDebugger.getEventListeners', params, (error, result) => {
                this.assertError(error, 'DOMDebugger.getEventListeners');
                resolve(result);
            });
        });
    }
}
exports.default = DOMDebugger;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRE9NRGVidWdnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9nZW5lcmF0ZWQtdHMvRE9NRGVidWdnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBc0M7QUFDdEMsbURBQTJDO0FBMkszQzs7R0FFRztBQUNIO0lBR0ksWUFBNkIsR0FBUSxDQUFDLHNCQUFzQjtRQUEvQixRQUFHLEdBQUgsR0FBRyxDQUFLLENBQUMsc0JBQXNCO1FBRnBELFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFBO1FBSS9CLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDekIsTUFBTSxJQUFJLEtBQUssQ0FBQyw4RUFBOEUsQ0FBQyxDQUFBO1FBQ25HLENBQUM7SUFDTCxDQUFDO0lBRU0sRUFBRSxDQUFDLEtBQWEsRUFBRSxRQUFrQjtRQUN2QyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUVNLElBQUksQ0FBQyxLQUFhLEVBQUUsUUFBa0I7UUFDekMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFTyxXQUFXLENBQUMsS0FBVSxFQUFFLFdBQW1CO1FBQy9DLEVBQUUsQ0FBQyxDQUFDLFNBQVMsSUFBSSxLQUFLLElBQUksTUFBTSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDeEMsTUFBTSxJQUFJLHVCQUFhLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFBO1FBQ25FLENBQUM7SUFDTCxDQUFDO0lBRUQsd0RBQXdEO0lBQ2pELEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxNQUEyQztRQUNyRSxNQUFNLENBQUMsTUFBTSxJQUFJLE9BQU8sQ0FBWSxDQUFD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QUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50cydcbmltcG9ydCBEZWJ1Z2dlckVycm9yIGZyb20gJy4vRGVidWdnZXJFcnJvcidcbmltcG9ydCBET00gZnJvbSAnLi9ET00nXG5pbXBvcnQgRGVidWdnZXIgZnJvbSAnLi9EZWJ1Z2dlcidcbmltcG9ydCBSdW50aW1lIGZyb20gJy4vUnVudGltZSdcblxubW9kdWxlIERPTURlYnVnZ2VyIHtcbiAgICAvKioqKioqKioqKioqKioqXG4gICAgICoqKiogVHlwZXMgKioqKlxuICAgICAqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIERPTSBicmVha3BvaW50IHR5cGUuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIGV4cG9ydCB0eXBlIERPTUJyZWFrcG9pbnRUeXBlID0gJ3N1YnRyZWUtbW9kaWZpZWQnIHwgJ2F0dHJpYnV0ZS1tb2RpZmllZCcgfCAnbm9kZS1yZW1vdmVkJ1xuXG4gICAgLyoqXG4gICAgICogT2JqZWN0IGV2ZW50IGxpc3RlbmVyLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBFdmVudExpc3RlbmVyID0ge1xuICAgICAgICAvKiogPGNvZGU+RXZlbnRMaXN0ZW5lcjwvY29kZT4ncyB0eXBlLiAqL1xuICAgICAgICB0eXBlOiBzdHJpbmdcblxuICAgICAgICAvKiogPGNvZGU+RXZlbnRMaXN0ZW5lcjwvY29kZT4ncyB1c2VDYXB0dXJlLiAqL1xuICAgICAgICB1c2VDYXB0dXJlOiBib29sZWFuXG5cbiAgICAgICAgLyoqIDxjb2RlPkV2ZW50TGlzdGVuZXI8L2NvZGU+J3MgcGFzc2l2ZSBmbGFnLiAqL1xuICAgICAgICBwYXNzaXZlOiBib29sZWFuXG5cbiAgICAgICAgLyoqIDxjb2RlPkV2ZW50TGlzdGVuZXI8L2NvZGU+J3Mgb25jZSBmbGFnLiAqL1xuICAgICAgICBvbmNlOiBib29sZWFuXG5cbiAgICAgICAgLyoqIFNjcmlwdCBpZCBvZiB0aGUgaGFuZGxlciBjb2RlLiAqL1xuICAgICAgICBzY3JpcHRJZDogUnVudGltZS5TY3JpcHRJZFxuXG4gICAgICAgIC8qKiBMaW5lIG51bWJlciBpbiB0aGUgc2NyaXB0ICgwLWJhc2VkKS4gKi9cbiAgICAgICAgbGluZU51bWJlcjogbnVtYmVyXG5cbiAgICAgICAgLyoqIENvbHVtbiBudW1iZXIgaW4gdGhlIHNjcmlwdCAoMC1iYXNlZCkuICovXG4gICAgICAgIGNvbHVtbk51bWJlcjogbnVtYmVyXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXIgZnVuY3Rpb24gdmFsdWUuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgaGFuZGxlcj86IFJ1bnRpbWUuUmVtb3RlT2JqZWN0XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IG9yaWdpbmFsIGhhbmRsZXIgZnVuY3Rpb24gdmFsdWUuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgb3JpZ2luYWxIYW5kbGVyPzogUnVudGltZS5SZW1vdGVPYmplY3RcblxuICAgICAgICAvKipcbiAgICAgICAgICogTm9kZSB0aGUgbGlzdGVuZXIgaXMgYWRkZWQgdG8gKGlmIGFueSkuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgYmFja2VuZE5vZGVJZD86IERPTS5CYWNrZW5kTm9kZUlkXG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBDb21tYW5kIFBhcmFtZXRlcnMgKioqKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZXhwb3J0IG1vZHVsZSBQYXJhbXMge1xuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRET01CcmVha3BvaW50ID0ge1xuICAgICAgICAgICAgLyoqIElkZW50aWZpZXIgb2YgdGhlIG5vZGUgdG8gc2V0IGJyZWFrcG9pbnQgb24uICovXG4gICAgICAgICAgICBub2RlSWQ6IERPTS5Ob2RlSWRcblxuICAgICAgICAgICAgLyoqIFR5cGUgb2YgdGhlIG9wZXJhdGlvbiB0byBzdG9wIHVwb24uICovXG4gICAgICAgICAgICB0eXBlOiBET01CcmVha3BvaW50VHlwZVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgcmVtb3ZlRE9NQnJlYWtwb2ludCA9IHtcbiAgICAgICAgICAgIC8qKiBJZGVudGlmaWVyIG9mIHRoZSBub2RlIHRvIHJlbW92ZSBicmVha3BvaW50IGZyb20uICovXG4gICAgICAgICAgICBub2RlSWQ6IERPTS5Ob2RlSWRcblxuICAgICAgICAgICAgLyoqIFR5cGUgb2YgdGhlIGJyZWFrcG9pbnQgdG8gcmVtb3ZlLiAqL1xuICAgICAgICAgICAgdHlwZTogRE9NQnJlYWtwb2ludFR5cGVcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNldEV2ZW50TGlzdGVuZXJCcmVha3BvaW50ID0ge1xuICAgICAgICAgICAgLyoqIERPTSBFdmVudCBuYW1lIHRvIHN0b3Agb24gKGFueSBET00gZXZlbnQgd2lsbCBkbykuICovXG4gICAgICAgICAgICBldmVudE5hbWU6IHN0cmluZ1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEV2ZW50VGFyZ2V0IGludGVyZmFjZSBuYW1lIHRvIHN0b3Agb24uIElmIGVxdWFsIHRvIDxjb2RlPlwiKlwiPC9jb2RlPiBvciBub3QgcHJvdmlkZWQsIHdpbGwgc3RvcCBvbiBhbnkgRXZlbnRUYXJnZXQuXG4gICAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGFyZ2V0TmFtZT86IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgcmVtb3ZlRXZlbnRMaXN0ZW5lckJyZWFrcG9pbnQgPSB7XG4gICAgICAgICAgICAvKiogRXZlbnQgbmFtZS4gKi9cbiAgICAgICAgICAgIGV2ZW50TmFtZTogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogRXZlbnRUYXJnZXQgaW50ZXJmYWNlIG5hbWUuXG4gICAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGFyZ2V0TmFtZT86IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgc2V0SW5zdHJ1bWVudGF0aW9uQnJlYWtwb2ludCA9IHtcbiAgICAgICAgICAgIC8qKiBJbnN0cnVtZW50YXRpb24gbmFtZSB0byBzdG9wIG9uLiAqL1xuICAgICAgICAgICAgZXZlbnROYW1lOiBzdHJpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHJlbW92ZUluc3RydW1lbnRhdGlvbkJyZWFrcG9pbnQgPSB7XG4gICAgICAgICAgICAvKiogSW5zdHJ1bWVudGF0aW9uIG5hbWUgdG8gc3RvcCBvbi4gKi9cbiAgICAgICAgICAgIGV2ZW50TmFtZTogc3RyaW5nXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRYSFJCcmVha3BvaW50ID0ge1xuICAgICAgICAgICAgLyoqIFJlc291cmNlIFVSTCBzdWJzdHJpbmcuIEFsbCBYSFJzIGhhdmluZyB0aGlzIHN1YnN0cmluZyBpbiB0aGUgVVJMIHdpbGwgZ2V0IHN0b3BwZWQgdXBvbi4gKi9cbiAgICAgICAgICAgIHVybDogc3RyaW5nXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSByZW1vdmVYSFJCcmVha3BvaW50ID0ge1xuICAgICAgICAgICAgLyoqIFJlc291cmNlIFVSTCBzdWJzdHJpbmcuICovXG4gICAgICAgICAgICB1cmw6IHN0cmluZ1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgZ2V0RXZlbnRMaXN0ZW5lcnMgPSB7XG4gICAgICAgICAgICAvKiogSWRlbnRpZmllciBvZiB0aGUgb2JqZWN0IHRvIHJldHVybiBsaXN0ZW5lcnMgZm9yLiAqL1xuICAgICAgICAgICAgb2JqZWN0SWQ6IFJ1bnRpbWUuUmVtb3RlT2JqZWN0SWRcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBUaGUgbWF4aW11bSBkZXB0aCBhdCB3aGljaCBOb2RlIGNoaWxkcmVuIHNob3VsZCBiZSByZXRyaWV2ZWQsIGRlZmF1bHRzIHRvIDEuIFVzZSAtMSBmb3IgdGhlIGVudGlyZSBzdWJ0cmVlIG9yIHByb3ZpZGUgYW4gaW50ZWdlciBsYXJnZXIgdGhhbiAwLlxuICAgICAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGRlcHRoPzogbnVtYmVyXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogV2hldGhlciBvciBub3QgaWZyYW1lcyBhbmQgc2hhZG93IHJvb3RzIHNob3VsZCBiZSB0cmF2ZXJzZWQgd2hlbiByZXR1cm5pbmcgdGhlIHN1YnRyZWUgKGRlZmF1bHQgaXMgZmFsc2UpLiBSZXBvcnRzIGxpc3RlbmVycyBmb3IgYWxsIGNvbnRleHRzIGlmIHBpZXJjZSBpcyBlbmFibGVkLlxuICAgICAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHBpZXJjZT86IGJvb2xlYW5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBDb21tYW5kIFJlc3VsdCAqKioqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGV4cG9ydCBtb2R1bGUgUmVzdWx0IHtcbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgZ2V0RXZlbnRMaXN0ZW5lcnMgPSB7XG4gICAgICAgICAgICAvKiogQXJyYXkgb2YgcmVsZXZhbnQgbGlzdGVuZXJzLiAqL1xuICAgICAgICAgICAgbGlzdGVuZXJzOiBFdmVudExpc3RlbmVyW11cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqKioqIEV2ZW50IFBhcmFtZXRlcnMgKioqKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG59XG5cbi8qKlxuICogRE9NIGRlYnVnZ2luZyBhbGxvd3Mgc2V0dGluZyBicmVha3BvaW50cyBvbiBwYXJ0aWN1bGFyIERPTSBvcGVyYXRpb25zIGFuZCBldmVudHMuIEphdmFTY3JpcHQgZXhlY3V0aW9uIHdpbGwgc3RvcCBvbiB0aGVzZSBvcGVyYXRpb25zIGFzIGlmIHRoZXJlIHdhcyBhIHJlZ3VsYXIgYnJlYWtwb2ludCBzZXQuXG4gKi9cbmNsYXNzIERPTURlYnVnZ2VyIHtcbiAgICBwcml2YXRlIGV2ZW50cyA9IG5ldyBFdmVudEVtaXR0ZXIoKVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBkYmc6IGFueSAvKiBFbGVjdHJvbi5EZWJ1Z2dlciovICkge1xuXG4gICAgICAgIGlmICghdGhpcy5kYmcuaXNBdHRhY2hlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBjcmVhdGUgRE9NRGVidWdnZXIgRG9tYWluIENsYXNzIGJlY2F1c2UgdGhlIGRlYnVnZ2VyIGlzIG5vdCBhdHRhY2hlZC5gKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIG9uKGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpXG4gICAgfVxuXG4gICAgcHVibGljIG9uY2UoZXZlbnQ6IHN0cmluZywgbGlzdGVuZXI6IEZ1bmN0aW9uKSB7XG4gICAgICAgIHRoaXMuZXZlbnRzLm9uKGV2ZW50LCBsaXN0ZW5lcilcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzc2VydEVycm9yKGVycm9yOiBhbnksIGNvbW1hbmROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCdtZXNzYWdlJyBpbiBlcnJvciAmJiAnY29kZScgaW4gZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBEZWJ1Z2dlckVycm9yKGVycm9yLm1lc3NhZ2UsIGVycm9yLmNvZGUsIGNvbW1hbmROYW1lKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIFNldHMgYnJlYWtwb2ludCBvbiBwYXJ0aWN1bGFyIG9wZXJhdGlvbiB3aXRoIERPTS4gKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0RE9NQnJlYWtwb2ludChwYXJhbXM6IERPTURlYnVnZ2VyLlBhcmFtcy5zZXRET01CcmVha3BvaW50KTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRE9NRGVidWdnZXIuc2V0RE9NQnJlYWtwb2ludCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0RPTURlYnVnZ2VyLnNldERPTUJyZWFrcG9pbnQnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogUmVtb3ZlcyBET00gYnJlYWtwb2ludCB0aGF0IHdhcyBzZXQgdXNpbmcgPGNvZGU+c2V0RE9NQnJlYWtwb2ludDwvY29kZT4uICovXG4gICAgcHVibGljIGFzeW5jIHJlbW92ZURPTUJyZWFrcG9pbnQocGFyYW1zOiBET01EZWJ1Z2dlci5QYXJhbXMucmVtb3ZlRE9NQnJlYWtwb2ludCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0RPTURlYnVnZ2VyLnJlbW92ZURPTUJyZWFrcG9pbnQnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdET01EZWJ1Z2dlci5yZW1vdmVET01CcmVha3BvaW50JylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIFNldHMgYnJlYWtwb2ludCBvbiBwYXJ0aWN1bGFyIERPTSBldmVudC4gKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0RXZlbnRMaXN0ZW5lckJyZWFrcG9pbnQocGFyYW1zOiBET01EZWJ1Z2dlci5QYXJhbXMuc2V0RXZlbnRMaXN0ZW5lckJyZWFrcG9pbnQpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdET01EZWJ1Z2dlci5zZXRFdmVudExpc3RlbmVyQnJlYWtwb2ludCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0RPTURlYnVnZ2VyLnNldEV2ZW50TGlzdGVuZXJCcmVha3BvaW50JylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIFJlbW92ZXMgYnJlYWtwb2ludCBvbiBwYXJ0aWN1bGFyIERPTSBldmVudC4gKi9cbiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlRXZlbnRMaXN0ZW5lckJyZWFrcG9pbnQocGFyYW1zOiBET01EZWJ1Z2dlci5QYXJhbXMucmVtb3ZlRXZlbnRMaXN0ZW5lckJyZWFrcG9pbnQpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdET01EZWJ1Z2dlci5yZW1vdmVFdmVudExpc3RlbmVyQnJlYWtwb2ludCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0RPTURlYnVnZ2VyLnJlbW92ZUV2ZW50TGlzdGVuZXJCcmVha3BvaW50JylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyBicmVha3BvaW50IG9uIHBhcnRpY3VsYXIgbmF0aXZlIGV2ZW50LlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0SW5zdHJ1bWVudGF0aW9uQnJlYWtwb2ludChwYXJhbXM6IERPTURlYnVnZ2VyLlBhcmFtcy5zZXRJbnN0cnVtZW50YXRpb25CcmVha3BvaW50KTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRE9NRGVidWdnZXIuc2V0SW5zdHJ1bWVudGF0aW9uQnJlYWtwb2ludCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0RPTURlYnVnZ2VyLnNldEluc3RydW1lbnRhdGlvbkJyZWFrcG9pbnQnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGJyZWFrcG9pbnQgb24gcGFydGljdWxhciBuYXRpdmUgZXZlbnQuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyByZW1vdmVJbnN0cnVtZW50YXRpb25CcmVha3BvaW50KHBhcmFtczogRE9NRGVidWdnZXIuUGFyYW1zLnJlbW92ZUluc3RydW1lbnRhdGlvbkJyZWFrcG9pbnQpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdET01EZWJ1Z2dlci5yZW1vdmVJbnN0cnVtZW50YXRpb25CcmVha3BvaW50JywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRE9NRGVidWdnZXIucmVtb3ZlSW5zdHJ1bWVudGF0aW9uQnJlYWtwb2ludCcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBTZXRzIGJyZWFrcG9pbnQgb24gWE1MSHR0cFJlcXVlc3QuICovXG4gICAgcHVibGljIGFzeW5jIHNldFhIUkJyZWFrcG9pbnQocGFyYW1zOiBET01EZWJ1Z2dlci5QYXJhbXMuc2V0WEhSQnJlYWtwb2ludCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0RPTURlYnVnZ2VyLnNldFhIUkJyZWFrcG9pbnQnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdET01EZWJ1Z2dlci5zZXRYSFJCcmVha3BvaW50JylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIFJlbW92ZXMgYnJlYWtwb2ludCBmcm9tIFhNTEh0dHBSZXF1ZXN0LiAqL1xuICAgIHB1YmxpYyBhc3luYyByZW1vdmVYSFJCcmVha3BvaW50KHBhcmFtczogRE9NRGVidWdnZXIuUGFyYW1zLnJlbW92ZVhIUkJyZWFrcG9pbnQpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdET01EZWJ1Z2dlci5yZW1vdmVYSFJCcmVha3BvaW50JywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRE9NRGVidWdnZXIucmVtb3ZlWEhSQnJlYWtwb2ludCcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgZXZlbnQgbGlzdGVuZXJzIG9mIHRoZSBnaXZlbiBvYmplY3QuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBnZXRFdmVudExpc3RlbmVycyhwYXJhbXM6IERPTURlYnVnZ2VyLlBhcmFtcy5nZXRFdmVudExpc3RlbmVycyk6IFByb21pc2U8RE9NRGVidWdnZXIuUmVzdWx0LmdldEV2ZW50TGlzdGVuZXJzPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPERPTURlYnVnZ2VyLlJlc3VsdC5nZXRFdmVudExpc3RlbmVycz4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0RPTURlYnVnZ2VyLmdldEV2ZW50TGlzdGVuZXJzJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRE9NRGVidWdnZXIuZ2V0RXZlbnRMaXN0ZW5lcnMnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0IGFzIERPTURlYnVnZ2VyLlJlc3VsdC5nZXRFdmVudExpc3RlbmVycylcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IERPTURlYnVnZ2VyIl19