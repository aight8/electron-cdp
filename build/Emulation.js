"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EventEmitter = require("events");
const DebuggerError_1 = require("./DebuggerError");
/**
 * This domain emulates different environments for the page.
 */
class Emulation {
    constructor(dbg /* Electron.Debugger*/) {
        this.dbg = dbg; /* Electron.Debugger*/
        this.events = new EventEmitter();
        this.dbg.on('message', (event, method, params) => {
            const [domain, domainMethod] = method.split('.');
            this.events.emit(domainMethod, params);
        });
        if (!this.dbg.isAttached()) {
            throw new Error(`Cannot create Emulation Domain Class because the debugger is not attached.`);
        }
    }
    on(event, listener) {
        this.events.on(event, listener);
    }
    once(event, listener) {
        this.events.on(event, listener);
    }
    assertError(error, commandName) {
        if ('message' in error && 'code' in error) {
            throw new DebuggerError_1.default(error.message, error.code, commandName);
        }
    }
    /** Overrides the values of device screen dimensions (window.screen.width, window.screen.height, window.innerWidth, window.innerHeight, and "device-width"/"device-height"-related CSS media query results). */
    async setDeviceMetricsOverride(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setDeviceMetricsOverride', params, (error, result) => {
                this.assertError(error, 'Emulation.setDeviceMetricsOverride');
                resolve();
            });
        });
    }
    /** Clears the overriden device metrics. */
    async clearDeviceMetricsOverride() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.clearDeviceMetricsOverride', {}, (error, result) => {
                this.assertError(error, 'Emulation.clearDeviceMetricsOverride');
                resolve();
            });
        });
    }
    /**
     * Overrides the visible area of the page. The change is hidden from the page, i.e. the observable scroll position and page scale does not change. In effect, the command moves the specified area of the page into the top-left corner of the frame.
     * @experimental
     */
    async forceViewport(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.forceViewport', params, (error, result) => {
                this.assertError(error, 'Emulation.forceViewport');
                resolve();
            });
        });
    }
    /**
     * Resets the visible area of the page to the original viewport, undoing any effects of the <code>forceViewport</code> command.
     * @experimental
     */
    async resetViewport() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.resetViewport', {}, (error, result) => {
                this.assertError(error, 'Emulation.resetViewport');
                resolve();
            });
        });
    }
    /**
     * Requests that page scale factor is reset to initial values.
     * @experimental
     */
    async resetPageScaleFactor() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.resetPageScaleFactor', {}, (error, result) => {
                this.assertError(error, 'Emulation.resetPageScaleFactor');
                resolve();
            });
        });
    }
    /**
     * Sets a specified page scale factor.
     * @experimental
     */
    async setPageScaleFactor(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setPageScaleFactor', params, (error, result) => {
                this.assertError(error, 'Emulation.setPageScaleFactor');
                resolve();
            });
        });
    }
    /**
     * Resizes the frame/viewport of the page. Note that this does not affect the frame's container (e.g. browser window). Can be used to produce screenshots of the specified size. Not supported on Android.
     * @experimental
     */
    async setVisibleSize(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setVisibleSize', params, (error, result) => {
                this.assertError(error, 'Emulation.setVisibleSize');
                resolve();
            });
        });
    }
    /**
     * Switches script execution in the page.
     * @experimental
     */
    async setScriptExecutionDisabled(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setScriptExecutionDisabled', params, (error, result) => {
                this.assertError(error, 'Emulation.setScriptExecutionDisabled');
                resolve();
            });
        });
    }
    /**
     * Overrides the Geolocation Position or Error. Omitting any of the parameters emulates position unavailable.
     * @experimental
     */
    async setGeolocationOverride(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setGeolocationOverride', params || {}, (error, result) => {
                this.assertError(error, 'Emulation.setGeolocationOverride');
                resolve();
            });
        });
    }
    /**
     * Clears the overriden Geolocation Position and Error.
     * @experimental
     */
    async clearGeolocationOverride() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.clearGeolocationOverride', {}, (error, result) => {
                this.assertError(error, 'Emulation.clearGeolocationOverride');
                resolve();
            });
        });
    }
    /** Toggles mouse event-based touch event emulation. */
    async setTouchEmulationEnabled(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setTouchEmulationEnabled', params, (error, result) => {
                this.assertError(error, 'Emulation.setTouchEmulationEnabled');
                resolve();
            });
        });
    }
    /** Emulates the given media for CSS media queries. */
    async setEmulatedMedia(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setEmulatedMedia', params, (error, result) => {
                this.assertError(error, 'Emulation.setEmulatedMedia');
                resolve();
            });
        });
    }
    /**
     * Enables CPU throttling to emulate slow CPUs.
     * @experimental
     */
    async setCPUThrottlingRate(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setCPUThrottlingRate', params, (error, result) => {
                this.assertError(error, 'Emulation.setCPUThrottlingRate');
                resolve();
            });
        });
    }
    /**
     * Tells whether emulation is supported.
     * @experimental
     */
    async canEmulate() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.canEmulate', {}, (error, result) => {
                this.assertError(error, 'Emulation.canEmulate');
                resolve(result);
            });
        });
    }
    /**
     * Turns on virtual time for all frames (replacing real-time with a synthetic time source) and sets the current virtual time policy.  Note this supersedes any previous time budget.
     * @experimental
     */
    async setVirtualTimePolicy(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setVirtualTimePolicy', params, (error, result) => {
                this.assertError(error, 'Emulation.setVirtualTimePolicy');
                resolve();
            });
        });
    }
    /**
     * Sets or clears an override of the default background color of the frame. This override is used if the content does not specify one.
     * @experimental
     */
    async setDefaultBackgroundColorOverride(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Emulation.setDefaultBackgroundColorOverride', params || {}, (error, result) => {
                this.assertError(error, 'Emulation.setDefaultBackgroundColorOverride');
                resolve();
            });
        });
    }
}
exports.default = Emulation;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRW11bGF0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vZ2VuZXJhdGVkLXRzL0VtdWxhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVDQUFzQztBQUN0QyxtREFBMkM7QUEyTzNDOztHQUVHO0FBQ0g7SUFHSSxZQUE2QixHQUFRLENBQUMsc0JBQXNCO1FBQS9CLFFBQUcsR0FBSCxHQUFHLENBQUssQ0FBQyxzQkFBc0I7UUFGcEQsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUE7UUFJL0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBVSxFQUFFLE1BQVcsRUFBRSxNQUFXO1lBQ3hELE1BQU0sQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtZQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDMUMsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3pCLE1BQU0sSUFBSSxLQUFLLENBQUMsNEVBQTRFLENBQUMsQ0FBQTtRQUNqRyxDQUFDO0lBQ0wsQ0FBQztJQUVNLEVBQUUsQ0FBQyxLQUFhLEVBQUUsUUFBa0I7UUFDdkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFTSxJQUFJLENBQUMsS0FBYSxFQUFFLFFBQWtCO1FBQ3pDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0lBRU8sV0FBVyxDQUFDLEtBQVUsRUFBRSxXQUFtQjtRQUMvQyxFQUFFLENBQUMsQ0FBQyxTQUFTLElBQUks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QUFDLFdBQVcsQ0FBQyxnQ0FBZ0MsRUFBRSxNQUFNLEVBQUUsQ0FBQyxLQUFVLEVBQUUsTUFBVztnQkFDbkYsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQTtnQkFDekQsT0FBTyxFQUFFLENBQUE7WUFDYixDQUFDLENBQUMsQ0FBQTtRQUNOLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQyxNQUEyRDtRQUN0RyxNQUFNLENBQUMsTUFBTSxJQUFJLE9BQU8sQ0FBWSxDQUFDLE9BQU8sRUFBRSxNQUFNO1lBQ2hELElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLDZDQUE2QyxFQUFFLE1BQU0sSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFVLEVBQUUsTUFBVztnQkFDdEcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsNkNBQTZDLENBQUMsQ0FBQTtnQkFDdEUsT0FBTyxFQUFFLENBQUE7WUFDYixDQUFDLENBQUMsQ0FBQTtRQUNOLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztDQUVKO0FBRUQsa0JBQWUsU0FBUyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50cydcbmltcG9ydCBEZWJ1Z2dlckVycm9yIGZyb20gJy4vRGVidWdnZXJFcnJvcidcbmltcG9ydCBET00gZnJvbSAnLi9ET00nXG5cbmRlY2xhcmUgaW50ZXJmYWNlIEVtdWxhdGlvbiB7XG5cbiAgICAvKipcbiAgICAgKiBOb3RpZmljYXRpb24gc2VudCBhZnRlciB0aGUgdmlydWFsIHRpbWUgYnVkZ2V0IGZvciB0aGUgY3VycmVudCBWaXJ0dWFsVGltZVBvbGljeSBoYXMgcnVuIG91dC5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgb24oZXZlbnQ6ICd2aXJ0dWFsVGltZUJ1ZGdldEV4cGlyZWQnLCBsaXN0ZW5lcjogKCkgPT4gdm9pZCk6IHZvaWRcbiAgICAvKipcbiAgICAgKiBOb3RpZmljYXRpb24gc2VudCBhZnRlciB0aGUgdmlydWFsIHRpbWUgYnVkZ2V0IGZvciB0aGUgY3VycmVudCBWaXJ0dWFsVGltZVBvbGljeSBoYXMgcnVuIG91dC5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgb25jZShldmVudDogJ3ZpcnR1YWxUaW1lQnVkZ2V0RXhwaXJlZCcsIGxpc3RlbmVyOiAoKSA9PiB2b2lkKTogdm9pZFxuXG59XG5cbm1vZHVsZSBFbXVsYXRpb24ge1xuICAgIC8qKioqKioqKioqKioqKipcbiAgICAgKioqKiBUeXBlcyAqKioqXG4gICAgICoqKioqKioqKioqKioqL1xuXG4gICAgLyoqXG4gICAgICogU2NyZWVuIG9yaWVudGF0aW9uLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBTY3JlZW5PcmllbnRhdGlvbiA9IHtcbiAgICAgICAgLyoqIE9yaWVudGF0aW9uIHR5cGUuICovXG4gICAgICAgIHR5cGU6ICdwb3J0cmFpdFByaW1hcnknIHwgJ3BvcnRyYWl0U2Vjb25kYXJ5JyB8ICdsYW5kc2NhcGVQcmltYXJ5JyB8ICdsYW5kc2NhcGVTZWNvbmRhcnknXG5cbiAgICAgICAgLyoqIE9yaWVudGF0aW9uIGFuZ2xlLiAqL1xuICAgICAgICBhbmdsZTogbnVtYmVyXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYWR2YW5jZTogSWYgdGhlIHNjaGVkdWxlciBydW5zIG91dCBvZiBpbW1lZGlhdGUgd29yaywgdGhlIHZpcnR1YWwgdGltZSBiYXNlIG1heSBmYXN0IGZvcndhcmQgdG8gYWxsb3cgdGhlIG5leHQgZGVsYXllZCB0YXNrIChpZiBhbnkpIHRvIHJ1bjsgcGF1c2U6IFRoZSB2aXJ0dWFsIHRpbWUgYmFzZSBtYXkgbm90IGFkdmFuY2U7IHBhdXNlSWZOZXR3b3JrRmV0Y2hlc1BlbmRpbmc6IFRoZSB2aXJ0dWFsIHRpbWUgYmFzZSBtYXkgbm90IGFkdmFuY2UgaWYgdGhlcmUgYXJlIGFueSBwZW5kaW5nIHJlc291cmNlIGZldGNoZXMuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIGV4cG9ydCB0eXBlIFZpcnR1YWxUaW1lUG9saWN5ID0gJ2FkdmFuY2UnIHwgJ3BhdXNlJyB8ICdwYXVzZUlmTmV0d29ya0ZldGNoZXNQZW5kaW5nJ1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBDb21tYW5kIFBhcmFtZXRlcnMgKioqKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZXhwb3J0IG1vZHVsZSBQYXJhbXMge1xuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXREZXZpY2VNZXRyaWNzT3ZlcnJpZGUgPSB7XG4gICAgICAgICAgICAvKiogT3ZlcnJpZGluZyB3aWR0aCB2YWx1ZSBpbiBwaXhlbHMgKG1pbmltdW0gMCwgbWF4aW11bSAxMDAwMDAwMCkuIDAgZGlzYWJsZXMgdGhlIG92ZXJyaWRlLiAqL1xuICAgICAgICAgICAgd2lkdGg6IG51bWJlclxuXG4gICAgICAgICAgICAvKiogT3ZlcnJpZGluZyBoZWlnaHQgdmFsdWUgaW4gcGl4ZWxzIChtaW5pbXVtIDAsIG1heGltdW0gMTAwMDAwMDApLiAwIGRpc2FibGVzIHRoZSBvdmVycmlkZS4gKi9cbiAgICAgICAgICAgIGhlaWdodDogbnVtYmVyXG5cbiAgICAgICAgICAgIC8qKiBPdmVycmlkaW5nIGRldmljZSBzY2FsZSBmYWN0b3IgdmFsdWUuIDAgZGlzYWJsZXMgdGhlIG92ZXJyaWRlLiAqL1xuICAgICAgICAgICAgZGV2aWNlU2NhbGVGYWN0b3I6IG51bWJlclxuXG4gICAgICAgICAgICAvKiogV2hldGhlciB0byBlbXVsYXRlIG1vYmlsZSBkZXZpY2UuIFRoaXMgaW5jbHVkZXMgdmlld3BvcnQgbWV0YSB0YWcsIG92ZXJsYXkgc2Nyb2xsYmFycywgdGV4dCBhdXRvc2l6aW5nIGFuZCBtb3JlLiAqL1xuICAgICAgICAgICAgbW9iaWxlOiBib29sZWFuXG5cbiAgICAgICAgICAgIC8qKiBXaGV0aGVyIGEgdmlldyB0aGF0IGV4Y2VlZHMgdGhlIGF2YWlsYWJsZSBicm93c2VyIHdpbmRvdyBhcmVhIHNob3VsZCBiZSBzY2FsZWQgZG93biB0byBmaXQuICovXG4gICAgICAgICAgICBmaXRXaW5kb3c6IGJvb2xlYW5cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY2FsZSB0byBhcHBseSB0byByZXN1bHRpbmcgdmlldyBpbWFnZS4gSWdub3JlZCBpbiB8Zml0V2luZG93fCBtb2RlLlxuICAgICAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNjYWxlPzogbnVtYmVyXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTm90IHVzZWQuXG4gICAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb2Zmc2V0WD86IG51bWJlclxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE5vdCB1c2VkLlxuICAgICAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9mZnNldFk/OiBudW1iZXJcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPdmVycmlkaW5nIHNjcmVlbiB3aWR0aCB2YWx1ZSBpbiBwaXhlbHMgKG1pbmltdW0gMCwgbWF4aW11bSAxMDAwMDAwMCkuIE9ubHkgdXNlZCBmb3IgfG1vYmlsZT09dHJ1ZXwuXG4gICAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2NyZWVuV2lkdGg/OiBudW1iZXJcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBPdmVycmlkaW5nIHNjcmVlbiBoZWlnaHQgdmFsdWUgaW4gcGl4ZWxzIChtaW5pbXVtIDAsIG1heGltdW0gMTAwMDAwMDApLiBPbmx5IHVzZWQgZm9yIHxtb2JpbGU9PXRydWV8LlxuICAgICAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNjcmVlbkhlaWdodD86IG51bWJlclxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE92ZXJyaWRpbmcgdmlldyBYIHBvc2l0aW9uIG9uIHNjcmVlbiBpbiBwaXhlbHMgKG1pbmltdW0gMCwgbWF4aW11bSAxMDAwMDAwMCkuIE9ubHkgdXNlZCBmb3IgfG1vYmlsZT09dHJ1ZXwuXG4gICAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgcG9zaXRpb25YPzogbnVtYmVyXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogT3ZlcnJpZGluZyB2aWV3IFkgcG9zaXRpb24gb24gc2NyZWVuIGluIHBpeGVscyAobWluaW11bSAwLCBtYXhpbXVtIDEwMDAwMDAwKS4gT25seSB1c2VkIGZvciB8bW9iaWxlPT10cnVlfC5cbiAgICAgICAgICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBwb3NpdGlvblk/OiBudW1iZXJcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBTY3JlZW4gb3JpZW50YXRpb24gb3ZlcnJpZGUuXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2NyZWVuT3JpZW50YXRpb24/OiBTY3JlZW5PcmllbnRhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgZm9yY2VWaWV3cG9ydCA9IHtcbiAgICAgICAgICAgIC8qKiBYIGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQgY29ybmVyIG9mIHRoZSBhcmVhIChDU1MgcGl4ZWxzKS4gKi9cbiAgICAgICAgICAgIHg6IG51bWJlclxuXG4gICAgICAgICAgICAvKiogWSBjb29yZGluYXRlIG9mIHRvcC1sZWZ0IGNvcm5lciBvZiB0aGUgYXJlYSAoQ1NTIHBpeGVscykuICovXG4gICAgICAgICAgICB5OiBudW1iZXJcblxuICAgICAgICAgICAgLyoqIFNjYWxlIHRvIGFwcGx5IHRvIHRoZSBhcmVhIChyZWxhdGl2ZSB0byBhIHBhZ2Ugc2NhbGUgb2YgMS4wKS4gKi9cbiAgICAgICAgICAgIHNjYWxlOiBudW1iZXJcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNldFBhZ2VTY2FsZUZhY3RvciA9IHtcbiAgICAgICAgICAgIC8qKiBQYWdlIHNjYWxlIGZhY3Rvci4gKi9cbiAgICAgICAgICAgIHBhZ2VTY2FsZUZhY3RvcjogbnVtYmVyXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRWaXNpYmxlU2l6ZSA9IHtcbiAgICAgICAgICAgIC8qKiBGcmFtZSB3aWR0aCAoRElQKS4gKi9cbiAgICAgICAgICAgIHdpZHRoOiBudW1iZXJcblxuICAgICAgICAgICAgLyoqIEZyYW1lIGhlaWdodCAoRElQKS4gKi9cbiAgICAgICAgICAgIGhlaWdodDogbnVtYmVyXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRTY3JpcHRFeGVjdXRpb25EaXNhYmxlZCA9IHtcbiAgICAgICAgICAgIC8qKiBXaGV0aGVyIHNjcmlwdCBleGVjdXRpb24gc2hvdWxkIGJlIGRpc2FibGVkIGluIHRoZSBwYWdlLiAqL1xuICAgICAgICAgICAgdmFsdWU6IGJvb2xlYW5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNldEdlb2xvY2F0aW9uT3ZlcnJpZGUgPSB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE1vY2sgbGF0aXR1ZGVcbiAgICAgICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBsYXRpdHVkZT86IG51bWJlclxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE1vY2sgbG9uZ2l0dWRlXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9uZ2l0dWRlPzogbnVtYmVyXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogTW9jayBhY2N1cmFjeVxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGFjY3VyYWN5PzogbnVtYmVyXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRUb3VjaEVtdWxhdGlvbkVuYWJsZWQgPSB7XG4gICAgICAgICAgICAvKiogV2hldGhlciB0aGUgdG91Y2ggZXZlbnQgZW11bGF0aW9uIHNob3VsZCBiZSBlbmFibGVkLiAqL1xuICAgICAgICAgICAgZW5hYmxlZDogYm9vbGVhblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRvdWNoL2dlc3R1cmUgZXZlbnRzIGNvbmZpZ3VyYXRpb24uIERlZmF1bHQ6IGN1cnJlbnQgcGxhdGZvcm0uXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uZmlndXJhdGlvbj86ICdtb2JpbGUnIHwgJ2Rlc2t0b3AnXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRFbXVsYXRlZE1lZGlhID0ge1xuICAgICAgICAgICAgLyoqIE1lZGlhIHR5cGUgdG8gZW11bGF0ZS4gRW1wdHkgc3RyaW5nIGRpc2FibGVzIHRoZSBvdmVycmlkZS4gKi9cbiAgICAgICAgICAgIG1lZGlhOiBzdHJpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAZXhwZXJpbWVudGFsICovXG4gICAgICAgIGV4cG9ydCB0eXBlIHNldENQVVRocm90dGxpbmdSYXRlID0ge1xuICAgICAgICAgICAgLyoqIFRocm90dGxpbmcgcmF0ZSBhcyBhIHNsb3dkb3duIGZhY3RvciAoMSBpcyBubyB0aHJvdHRsZSwgMiBpcyAyeCBzbG93ZG93biwgZXRjKS4gKi9cbiAgICAgICAgICAgIHJhdGU6IG51bWJlclxuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgc2V0VmlydHVhbFRpbWVQb2xpY3kgPSB7XG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIHBvbGljeTogVmlydHVhbFRpbWVQb2xpY3lcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJZiBzZXQsIGFmdGVyIHRoaXMgbWFueSB2aXJ0dWFsIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWQgdmlydHVhbCB0aW1lIHdpbGwgYmUgcGF1c2VkIGFuZCBhIHZpcnR1YWxUaW1lQnVkZ2V0RXhwaXJlZCBldmVudCBpcyBzZW50LlxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJ1ZGdldD86IG51bWJlclxuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgc2V0RGVmYXVsdEJhY2tncm91bmRDb2xvck92ZXJyaWRlID0ge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBSR0JBIG9mIHRoZSBkZWZhdWx0IGJhY2tncm91bmQgY29sb3IuIElmIG5vdCBzcGVjaWZpZWQsIGFueSBleGlzdGluZyBvdmVycmlkZSB3aWxsIGJlIGNsZWFyZWQuXG4gICAgICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29sb3I/OiBET00uUkdCQVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqKioqIENvbW1hbmQgUmVzdWx0ICoqKipcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZXhwb3J0IG1vZHVsZSBSZXN1bHQge1xuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBjYW5FbXVsYXRlID0ge1xuICAgICAgICAgICAgLyoqIFRydWUgaWYgZW11bGF0aW9uIGlzIHN1cHBvcnRlZC4gKi9cbiAgICAgICAgICAgIHJlc3VsdDogYm9vbGVhblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICoqKiogRXZlbnQgUGFyYW1ldGVycyAqKioqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbn1cblxuLyoqXG4gKiBUaGlzIGRvbWFpbiBlbXVsYXRlcyBkaWZmZXJlbnQgZW52aXJvbm1lbnRzIGZvciB0aGUgcGFnZS5cbiAqL1xuY2xhc3MgRW11bGF0aW9uIHtcbiAgICBwcml2YXRlIGV2ZW50cyA9IG5ldyBFdmVudEVtaXR0ZXIoKVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBkYmc6IGFueSAvKiBFbGVjdHJvbi5EZWJ1Z2dlciovICkge1xuXG4gICAgICAgIHRoaXMuZGJnLm9uKCdtZXNzYWdlJywgKGV2ZW50OiBhbnksIG1ldGhvZDogYW55LCBwYXJhbXM6IGFueSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgW2RvbWFpbiwgZG9tYWluTWV0aG9kXSA9IG1ldGhvZC5zcGxpdCgnLicpXG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5lbWl0KGRvbWFpbk1ldGhvZCwgcGFyYW1zKVxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICghdGhpcy5kYmcuaXNBdHRhY2hlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBjcmVhdGUgRW11bGF0aW9uIERvbWFpbiBDbGFzcyBiZWNhdXNlIHRoZSBkZWJ1Z2dlciBpcyBub3QgYXR0YWNoZWQuYClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBvbihldmVudDogc3RyaW5nLCBsaXN0ZW5lcjogRnVuY3Rpb24pIHtcbiAgICAgICAgdGhpcy5ldmVudHMub24oZXZlbnQsIGxpc3RlbmVyKVxuICAgIH1cblxuICAgIHB1YmxpYyBvbmNlKGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3NlcnRFcnJvcihlcnJvcjogYW55LCBjb21tYW5kTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICgnbWVzc2FnZScgaW4gZXJyb3IgJiYgJ2NvZGUnIGluIGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRGVidWdnZXJFcnJvcihlcnJvci5tZXNzYWdlLCBlcnJvci5jb2RlLCBjb21tYW5kTmFtZSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBPdmVycmlkZXMgdGhlIHZhbHVlcyBvZiBkZXZpY2Ugc2NyZWVuIGRpbWVuc2lvbnMgKHdpbmRvdy5zY3JlZW4ud2lkdGgsIHdpbmRvdy5zY3JlZW4uaGVpZ2h0LCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0LCBhbmQgXCJkZXZpY2Utd2lkdGhcIi9cImRldmljZS1oZWlnaHRcIi1yZWxhdGVkIENTUyBtZWRpYSBxdWVyeSByZXN1bHRzKS4gKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0RGV2aWNlTWV0cmljc092ZXJyaWRlKHBhcmFtczogRW11bGF0aW9uLlBhcmFtcy5zZXREZXZpY2VNZXRyaWNzT3ZlcnJpZGUpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdFbXVsYXRpb24uc2V0RGV2aWNlTWV0cmljc092ZXJyaWRlJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRW11bGF0aW9uLnNldERldmljZU1ldHJpY3NPdmVycmlkZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBDbGVhcnMgdGhlIG92ZXJyaWRlbiBkZXZpY2UgbWV0cmljcy4gKi9cbiAgICBwdWJsaWMgYXN5bmMgY2xlYXJEZXZpY2VNZXRyaWNzT3ZlcnJpZGUoKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRW11bGF0aW9uLmNsZWFyRGV2aWNlTWV0cmljc092ZXJyaWRlJywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uY2xlYXJEZXZpY2VNZXRyaWNzT3ZlcnJpZGUnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdmVycmlkZXMgdGhlIHZpc2libGUgYXJlYSBvZiB0aGUgcGFnZS4gVGhlIGNoYW5nZSBpcyBoaWRkZW4gZnJvbSB0aGUgcGFnZSwgaS5lLiB0aGUgb2JzZXJ2YWJsZSBzY3JvbGwgcG9zaXRpb24gYW5kIHBhZ2Ugc2NhbGUgZG9lcyBub3QgY2hhbmdlLiBJbiBlZmZlY3QsIHRoZSBjb21tYW5kIG1vdmVzIHRoZSBzcGVjaWZpZWQgYXJlYSBvZiB0aGUgcGFnZSBpbnRvIHRoZSB0b3AtbGVmdCBjb3JuZXIgb2YgdGhlIGZyYW1lLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgZm9yY2VWaWV3cG9ydChwYXJhbXM6IEVtdWxhdGlvbi5QYXJhbXMuZm9yY2VWaWV3cG9ydCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5mb3JjZVZpZXdwb3J0JywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRW11bGF0aW9uLmZvcmNlVmlld3BvcnQnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHZpc2libGUgYXJlYSBvZiB0aGUgcGFnZSB0byB0aGUgb3JpZ2luYWwgdmlld3BvcnQsIHVuZG9pbmcgYW55IGVmZmVjdHMgb2YgdGhlIDxjb2RlPmZvcmNlVmlld3BvcnQ8L2NvZGU+IGNvbW1hbmQuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyByZXNldFZpZXdwb3J0KCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5yZXNldFZpZXdwb3J0Jywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24ucmVzZXRWaWV3cG9ydCcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcXVlc3RzIHRoYXQgcGFnZSBzY2FsZSBmYWN0b3IgaXMgcmVzZXQgdG8gaW5pdGlhbCB2YWx1ZXMuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyByZXNldFBhZ2VTY2FsZUZhY3RvcigpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdFbXVsYXRpb24ucmVzZXRQYWdlU2NhbGVGYWN0b3InLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0VtdWxhdGlvbi5yZXNldFBhZ2VTY2FsZUZhY3RvcicpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgYSBzcGVjaWZpZWQgcGFnZSBzY2FsZSBmYWN0b3IuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBzZXRQYWdlU2NhbGVGYWN0b3IocGFyYW1zOiBFbXVsYXRpb24uUGFyYW1zLnNldFBhZ2VTY2FsZUZhY3Rvcik6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5zZXRQYWdlU2NhbGVGYWN0b3InLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uc2V0UGFnZVNjYWxlRmFjdG9yJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzaXplcyB0aGUgZnJhbWUvdmlld3BvcnQgb2YgdGhlIHBhZ2UuIE5vdGUgdGhhdCB0aGlzIGRvZXMgbm90IGFmZmVjdCB0aGUgZnJhbWUncyBjb250YWluZXIgKGUuZy4gYnJvd3NlciB3aW5kb3cpLiBDYW4gYmUgdXNlZCB0byBwcm9kdWNlIHNjcmVlbnNob3RzIG9mIHRoZSBzcGVjaWZpZWQgc2l6ZS4gTm90IHN1cHBvcnRlZCBvbiBBbmRyb2lkLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0VmlzaWJsZVNpemUocGFyYW1zOiBFbXVsYXRpb24uUGFyYW1zLnNldFZpc2libGVTaXplKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRW11bGF0aW9uLnNldFZpc2libGVTaXplJywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRW11bGF0aW9uLnNldFZpc2libGVTaXplJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3dpdGNoZXMgc2NyaXB0IGV4ZWN1dGlvbiBpbiB0aGUgcGFnZS5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIHNldFNjcmlwdEV4ZWN1dGlvbkRpc2FibGVkKHBhcmFtczogRW11bGF0aW9uLlBhcmFtcy5zZXRTY3JpcHRFeGVjdXRpb25EaXNhYmxlZCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5zZXRTY3JpcHRFeGVjdXRpb25EaXNhYmxlZCcsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0VtdWxhdGlvbi5zZXRTY3JpcHRFeGVjdXRpb25EaXNhYmxlZCcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlcyB0aGUgR2VvbG9jYXRpb24gUG9zaXRpb24gb3IgRXJyb3IuIE9taXR0aW5nIGFueSBvZiB0aGUgcGFyYW1ldGVycyBlbXVsYXRlcyBwb3NpdGlvbiB1bmF2YWlsYWJsZS5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIHNldEdlb2xvY2F0aW9uT3ZlcnJpZGUocGFyYW1zPzogRW11bGF0aW9uLlBhcmFtcy5zZXRHZW9sb2NhdGlvbk92ZXJyaWRlKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRW11bGF0aW9uLnNldEdlb2xvY2F0aW9uT3ZlcnJpZGUnLCBwYXJhbXMgfHwge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uc2V0R2VvbG9jYXRpb25PdmVycmlkZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgb3ZlcnJpZGVuIEdlb2xvY2F0aW9uIFBvc2l0aW9uIGFuZCBFcnJvci5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGNsZWFyR2VvbG9jYXRpb25PdmVycmlkZSgpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdFbXVsYXRpb24uY2xlYXJHZW9sb2NhdGlvbk92ZXJyaWRlJywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uY2xlYXJHZW9sb2NhdGlvbk92ZXJyaWRlJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIFRvZ2dsZXMgbW91c2UgZXZlbnQtYmFzZWQgdG91Y2ggZXZlbnQgZW11bGF0aW9uLiAqL1xuICAgIHB1YmxpYyBhc3luYyBzZXRUb3VjaEVtdWxhdGlvbkVuYWJsZWQocGFyYW1zOiBFbXVsYXRpb24uUGFyYW1zLnNldFRvdWNoRW11bGF0aW9uRW5hYmxlZCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5zZXRUb3VjaEVtdWxhdGlvbkVuYWJsZWQnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uc2V0VG91Y2hFbXVsYXRpb25FbmFibGVkJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIEVtdWxhdGVzIHRoZSBnaXZlbiBtZWRpYSBmb3IgQ1NTIG1lZGlhIHF1ZXJpZXMuICovXG4gICAgcHVibGljIGFzeW5jIHNldEVtdWxhdGVkTWVkaWEocGFyYW1zOiBFbXVsYXRpb24uUGFyYW1zLnNldEVtdWxhdGVkTWVkaWEpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdFbXVsYXRpb24uc2V0RW11bGF0ZWRNZWRpYScsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0VtdWxhdGlvbi5zZXRFbXVsYXRlZE1lZGlhJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBDUFUgdGhyb3R0bGluZyB0byBlbXVsYXRlIHNsb3cgQ1BVcy5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIHNldENQVVRocm90dGxpbmdSYXRlKHBhcmFtczogRW11bGF0aW9uLlBhcmFtcy5zZXRDUFVUaHJvdHRsaW5nUmF0ZSk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5zZXRDUFVUaHJvdHRsaW5nUmF0ZScsIHBhcmFtcywgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0VtdWxhdGlvbi5zZXRDUFVUaHJvdHRsaW5nUmF0ZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlbGxzIHdoZXRoZXIgZW11bGF0aW9uIGlzIHN1cHBvcnRlZC5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGNhbkVtdWxhdGUoKTogUHJvbWlzZTxFbXVsYXRpb24uUmVzdWx0LmNhbkVtdWxhdGU+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8RW11bGF0aW9uLlJlc3VsdC5jYW5FbXVsYXRlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRW11bGF0aW9uLmNhbkVtdWxhdGUnLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ0VtdWxhdGlvbi5jYW5FbXVsYXRlJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCBhcyBFbXVsYXRpb24uUmVzdWx0LmNhbkVtdWxhdGUpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFR1cm5zIG9uIHZpcnR1YWwgdGltZSBmb3IgYWxsIGZyYW1lcyAocmVwbGFjaW5nIHJlYWwtdGltZSB3aXRoIGEgc3ludGhldGljIHRpbWUgc291cmNlKSBhbmQgc2V0cyB0aGUgY3VycmVudCB2aXJ0dWFsIHRpbWUgcG9saWN5LiAgTm90ZSB0aGlzIHN1cGVyc2VkZXMgYW55IHByZXZpb3VzIHRpbWUgYnVkZ2V0LlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgc2V0VmlydHVhbFRpbWVQb2xpY3kocGFyYW1zOiBFbXVsYXRpb24uUGFyYW1zLnNldFZpcnR1YWxUaW1lUG9saWN5KTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnRW11bGF0aW9uLnNldFZpcnR1YWxUaW1lUG9saWN5JywgcGFyYW1zLCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnRW11bGF0aW9uLnNldFZpcnR1YWxUaW1lUG9saWN5JylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyBvciBjbGVhcnMgYW4gb3ZlcnJpZGUgb2YgdGhlIGRlZmF1bHQgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgZnJhbWUuIFRoaXMgb3ZlcnJpZGUgaXMgdXNlZCBpZiB0aGUgY29udGVudCBkb2VzIG5vdCBzcGVjaWZ5IG9uZS5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIHNldERlZmF1bHRCYWNrZ3JvdW5kQ29sb3JPdmVycmlkZShwYXJhbXM/OiBFbXVsYXRpb24uUGFyYW1zLnNldERlZmF1bHRCYWNrZ3JvdW5kQ29sb3JPdmVycmlkZSk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ0VtdWxhdGlvbi5zZXREZWZhdWx0QmFja2dyb3VuZENvbG9yT3ZlcnJpZGUnLCBwYXJhbXMgfHwge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdFbXVsYXRpb24uc2V0RGVmYXVsdEJhY2tncm91bmRDb2xvck92ZXJyaWRlJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IEVtdWxhdGlvbiJdfQ==