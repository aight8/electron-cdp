"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EventEmitter = require("events");
const DebuggerError_1 = require("./DebuggerError");
/**
 * No description
 */
class Profiler {
    constructor(dbg /* Electron.Debugger*/) {
        this.dbg = dbg; /* Electron.Debugger*/
        this.events = new EventEmitter();
        this.dbg.on('message', (event, method, params) => {
            const [domain, domainMethod] = method.split('.');
            this.events.emit(domainMethod, params);
        });
        if (!this.dbg.isAttached()) {
            throw new Error(`Cannot create Profiler Domain Class because the debugger is not attached.`);
        }
    }
    on(event, listener) {
        this.events.on(event, listener);
    }
    once(event, listener) {
        this.events.on(event, listener);
    }
    assertError(error, commandName) {
        if ('message' in error && 'code' in error) {
            throw new DebuggerError_1.default(error.message, error.code, commandName);
        }
    }
    /** No description */
    async enable() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.enable', {}, (error, result) => {
                this.assertError(error, 'Profiler.enable');
                resolve();
            });
        });
    }
    /** No description */
    async disable() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.disable', {}, (error, result) => {
                this.assertError(error, 'Profiler.disable');
                resolve();
            });
        });
    }
    /** Changes CPU profiler sampling interval. Must be called before CPU profiles recording started. */
    async setSamplingInterval(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.setSamplingInterval', params, (error, result) => {
                this.assertError(error, 'Profiler.setSamplingInterval');
                resolve();
            });
        });
    }
    /** No description */
    async start() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.start', {}, (error, result) => {
                this.assertError(error, 'Profiler.start');
                resolve();
            });
        });
    }
    /** No description */
    async stop() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.stop', {}, (error, result) => {
                this.assertError(error, 'Profiler.stop');
                resolve(result);
            });
        });
    }
    /**
     * Enable precise code coverage. Coverage data for JavaScript executed before enabling precise code coverage may be incomplete. Enabling prevents running optimized code and resets execution counters.
     * @experimental
     */
    async startPreciseCoverage(params) {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.startPreciseCoverage', params || {}, (error, result) => {
                this.assertError(error, 'Profiler.startPreciseCoverage');
                resolve();
            });
        });
    }
    /**
     * Disable precise code coverage. Disabling releases unnecessary execution count records and allows executing optimized code.
     * @experimental
     */
    async stopPreciseCoverage() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.stopPreciseCoverage', {}, (error, result) => {
                this.assertError(error, 'Profiler.stopPreciseCoverage');
                resolve();
            });
        });
    }
    /**
     * Collect coverage data for the current isolate, and resets execution counters. Precise code coverage needs to have started.
     * @experimental
     */
    async takePreciseCoverage() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.takePreciseCoverage', {}, (error, result) => {
                this.assertError(error, 'Profiler.takePreciseCoverage');
                resolve(result);
            });
        });
    }
    /**
     * Collect coverage data for the current isolate. The coverage data may be incomplete due to garbage collection.
     * @experimental
     */
    async getBestEffortCoverage() {
        return await new Promise((resolve, reject) => {
            this.dbg.sendCommand('Profiler.getBestEffortCoverage', {}, (error, result) => {
                this.assertError(error, 'Profiler.getBestEffortCoverage');
                resolve(result);
            });
        });
    }
}
exports.default = Profiler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvZmlsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9nZW5lcmF0ZWQtdHMvUHJvZmlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBc0M7QUFDdEMsbURBQTJDO0FBbU8zQzs7R0FFRztBQUNIO0lBR0ksWUFBNkIsR0FBUSxDQUFDLHNCQUFzQjtRQUEvQixRQUFHLEdBQUgsR0FBRyxDQUFLLENBQUMsc0JBQXNCO1FBRnBELFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFBO1FBSS9CLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQVUsRUFBRSxNQUFXLEVBQUUsTUFBVztZQUN4RCxNQUFNLENBQUMsTUFBTSxFQUFFLFlBQVksQ0FBQyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDaEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLE1BQU0sQ0FBQyxDQUFBO1FBQzFDLENBQUMsQ0FBQyxDQUFBO1FBRUYsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN6QixNQUFNLElBQUksS0FBSyxDQUFDLDJFQUEyRSxDQUFDLENBQUE7UUFDaEcsQ0FBQztJQUNMLENBQUM7SUFFTSxFQUFFLENBQUMsS0FBYSxFQUFFLFFBQWtCO1FBQ3ZDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0lBRU0sSUFBSSxDQUFDLEtBQWEsRUFBRSxRQUFrQjtRQUN6QyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUE7SUFDbkMsQ0FBQztJQUVPLFdBQVcsQ0FBQyxLQUFVLEVBQUUsV0FBbUI7UUFDL0MsRUFBRSxDQUFDLENBQUMsU0FBUyxJQUFJLEtB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LE1BQVc7Z0JBQy9FLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLGdDQUFnQyxDQUFDLENBQUE7Z0JBQ3pELE9BQU8sQ0FBQyxNQUErQyxDQUFDLENBQUE7WUFDNUQsQ0FBQyxDQUFDLENBQUE7UUFDTixDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7Q0FFSjtBQUVELGtCQUFlLFFBQVEsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEV2ZW50RW1pdHRlciBmcm9tICdldmVudHMnXG5pbXBvcnQgRGVidWdnZXJFcnJvciBmcm9tICcuL0RlYnVnZ2VyRXJyb3InXG5pbXBvcnQgUnVudGltZSBmcm9tICcuL1J1bnRpbWUnXG5pbXBvcnQgRGVidWdnZXIgZnJvbSAnLi9EZWJ1Z2dlcidcblxuZGVjbGFyZSBpbnRlcmZhY2UgUHJvZmlsZXIge1xuXG4gICAgLyoqIFNlbnQgd2hlbiBuZXcgcHJvZmlsZSByZWNvcmRpbmcgaXMgc3RhcnRlZCB1c2luZyBjb25zb2xlLnByb2ZpbGUoKSBjYWxsLiAqL1xuICAgIG9uKGV2ZW50OiAnY29uc29sZVByb2ZpbGVTdGFydGVkJywgbGlzdGVuZXI6IChwYXJhbXM6IFByb2ZpbGVyLkV2ZW50UGFyYW1zLmNvbnNvbGVQcm9maWxlU3RhcnRlZCkgPT4gdm9pZCk6IHZvaWRcbiAgICAvKiogU2VudCB3aGVuIG5ldyBwcm9maWxlIHJlY29yZGluZyBpcyBzdGFydGVkIHVzaW5nIGNvbnNvbGUucHJvZmlsZSgpIGNhbGwuICovXG4gICAgb25jZShldmVudDogJ2NvbnNvbGVQcm9maWxlU3RhcnRlZCcsIGxpc3RlbmVyOiAocGFyYW1zOiBQcm9maWxlci5FdmVudFBhcmFtcy5jb25zb2xlUHJvZmlsZVN0YXJ0ZWQpID0+IHZvaWQpOiB2b2lkXG5cbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBvbihldmVudDogJ2NvbnNvbGVQcm9maWxlRmluaXNoZWQnLCBsaXN0ZW5lcjogKHBhcmFtczogUHJvZmlsZXIuRXZlbnRQYXJhbXMuY29uc29sZVByb2ZpbGVGaW5pc2hlZCkgPT4gdm9pZCk6IHZvaWRcbiAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICBvbmNlKGV2ZW50OiAnY29uc29sZVByb2ZpbGVGaW5pc2hlZCcsIGxpc3RlbmVyOiAocGFyYW1zOiBQcm9maWxlci5FdmVudFBhcmFtcy5jb25zb2xlUHJvZmlsZUZpbmlzaGVkKSA9PiB2b2lkKTogdm9pZFxuXG59XG5cbm1vZHVsZSBQcm9maWxlciB7XG4gICAgLyoqKioqKioqKioqKioqKlxuICAgICAqKioqIFR5cGVzICoqKipcbiAgICAgKioqKioqKioqKioqKiovXG5cbiAgICAvKipcbiAgICAgKiBQcm9maWxlIG5vZGUuIEhvbGRzIGNhbGxzaXRlIGluZm9ybWF0aW9uLCBleGVjdXRpb24gc3RhdGlzdGljcyBhbmQgY2hpbGQgbm9kZXMuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIGV4cG9ydCB0eXBlIFByb2ZpbGVOb2RlID0ge1xuICAgICAgICAvKiogVW5pcXVlIGlkIG9mIHRoZSBub2RlLiAqL1xuICAgICAgICBpZDogbnVtYmVyXG5cbiAgICAgICAgLyoqIEZ1bmN0aW9uIGxvY2F0aW9uLiAqL1xuICAgICAgICBjYWxsRnJhbWU6IFJ1bnRpbWUuQ2FsbEZyYW1lXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE51bWJlciBvZiBzYW1wbGVzIHdoZXJlIHRoaXMgbm9kZSB3YXMgb24gdG9wIG9mIHRoZSBjYWxsIHN0YWNrLlxuICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgaGl0Q291bnQ/OiBudW1iZXJcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hpbGQgbm9kZSBpZHMuXG4gICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgKi9cbiAgICAgICAgY2hpbGRyZW4/OiBudW1iZXJbXVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVhc29uIG9mIGJlaW5nIG5vdCBvcHRpbWl6ZWQuIFRoZSBmdW5jdGlvbiBtYXkgYmUgZGVvcHRpbWl6ZWQgb3IgbWFya2VkIGFzIGRvbid0IG9wdGltaXplLlxuICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICovXG4gICAgICAgIGRlb3B0UmVhc29uPzogc3RyaW5nXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGFycmF5IG9mIHNvdXJjZSBwb3NpdGlvbiB0aWNrcy5cbiAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICovXG4gICAgICAgIHBvc2l0aW9uVGlja3M/OiBQb3NpdGlvblRpY2tJbmZvW11cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9maWxlLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBQcm9maWxlID0ge1xuICAgICAgICAvKiogVGhlIGxpc3Qgb2YgcHJvZmlsZSBub2Rlcy4gRmlyc3QgaXRlbSBpcyB0aGUgcm9vdCBub2RlLiAqL1xuICAgICAgICBub2RlczogUHJvZmlsZU5vZGVbXVxuXG4gICAgICAgIC8qKiBQcm9maWxpbmcgc3RhcnQgdGltZXN0YW1wIGluIG1pY3Jvc2Vjb25kcy4gKi9cbiAgICAgICAgc3RhcnRUaW1lOiBudW1iZXJcblxuICAgICAgICAvKiogUHJvZmlsaW5nIGVuZCB0aW1lc3RhbXAgaW4gbWljcm9zZWNvbmRzLiAqL1xuICAgICAgICBlbmRUaW1lOiBudW1iZXJcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWRzIG9mIHNhbXBsZXMgdG9wIG5vZGVzLlxuICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICovXG4gICAgICAgIHNhbXBsZXM/OiBudW1iZXJbXVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaW1lIGludGVydmFscyBiZXR3ZWVuIGFkamFjZW50IHNhbXBsZXMgaW4gbWljcm9zZWNvbmRzLiBUaGUgZmlyc3QgZGVsdGEgaXMgcmVsYXRpdmUgdG8gdGhlIHByb2ZpbGUgc3RhcnRUaW1lLlxuICAgICAgICAgKiBAb3B0aW9uYWxcbiAgICAgICAgICovXG4gICAgICAgIHRpbWVEZWx0YXM/OiBudW1iZXJbXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyBhIG51bWJlciBvZiBzYW1wbGVzIGF0dHJpYnV0ZWQgdG8gYSBjZXJ0YWluIHNvdXJjZSBwb3NpdGlvbi5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgZXhwb3J0IHR5cGUgUG9zaXRpb25UaWNrSW5mbyA9IHtcbiAgICAgICAgLyoqIFNvdXJjZSBsaW5lIG51bWJlciAoMS1iYXNlZCkuICovXG4gICAgICAgIGxpbmU6IG51bWJlclxuXG4gICAgICAgIC8qKiBOdW1iZXIgb2Ygc2FtcGxlcyBhdHRyaWJ1dGVkIHRvIHRoZSBzb3VyY2UgbGluZS4gKi9cbiAgICAgICAgdGlja3M6IG51bWJlclxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvdmVyYWdlIGRhdGEgZm9yIGEgc291cmNlIHJhbmdlLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBDb3ZlcmFnZVJhbmdlID0ge1xuICAgICAgICAvKiogSmF2YVNjcmlwdCBzY3JpcHQgc291cmNlIG9mZnNldCBmb3IgdGhlIHJhbmdlIHN0YXJ0LiAqL1xuICAgICAgICBzdGFydE9mZnNldDogbnVtYmVyXG5cbiAgICAgICAgLyoqIEphdmFTY3JpcHQgc2NyaXB0IHNvdXJjZSBvZmZzZXQgZm9yIHRoZSByYW5nZSBlbmQuICovXG4gICAgICAgIGVuZE9mZnNldDogbnVtYmVyXG5cbiAgICAgICAgLyoqIENvbGxlY3RlZCBleGVjdXRpb24gY291bnQgb2YgdGhlIHNvdXJjZSByYW5nZS4gKi9cbiAgICAgICAgY291bnQ6IG51bWJlclxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvdmVyYWdlIGRhdGEgZm9yIGEgSmF2YVNjcmlwdCBmdW5jdGlvbi5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgZXhwb3J0IHR5cGUgRnVuY3Rpb25Db3ZlcmFnZSA9IHtcbiAgICAgICAgLyoqIEphdmFTY3JpcHQgZnVuY3Rpb24gbmFtZS4gKi9cbiAgICAgICAgZnVuY3Rpb25OYW1lOiBzdHJpbmdcblxuICAgICAgICAvKiogU291cmNlIHJhbmdlcyBpbnNpZGUgdGhlIGZ1bmN0aW9uIHdpdGggY292ZXJhZ2UgZGF0YS4gKi9cbiAgICAgICAgcmFuZ2VzOiBDb3ZlcmFnZVJhbmdlW11cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3ZlcmFnZSBkYXRhIGZvciBhIEphdmFTY3JpcHQgc2NyaXB0LlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBleHBvcnQgdHlwZSBTY3JpcHRDb3ZlcmFnZSA9IHtcbiAgICAgICAgLyoqIEphdmFTY3JpcHQgc2NyaXB0IGlkLiAqL1xuICAgICAgICBzY3JpcHRJZDogUnVudGltZS5TY3JpcHRJZFxuXG4gICAgICAgIC8qKiBKYXZhU2NyaXB0IHNjcmlwdCBuYW1lIG9yIHVybC4gKi9cbiAgICAgICAgdXJsOiBzdHJpbmdcblxuICAgICAgICAvKiogRnVuY3Rpb25zIGNvbnRhaW5lZCBpbiB0aGUgc2NyaXB0IHRoYXQgaGFzIGNvdmVyYWdlIGRhdGEuICovXG4gICAgICAgIGZ1bmN0aW9uczogRnVuY3Rpb25Db3ZlcmFnZVtdXG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBDb21tYW5kIFBhcmFtZXRlcnMgKioqKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZXhwb3J0IG1vZHVsZSBQYXJhbXMge1xuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzZXRTYW1wbGluZ0ludGVydmFsID0ge1xuICAgICAgICAgICAgLyoqIE5ldyBzYW1wbGluZyBpbnRlcnZhbCBpbiBtaWNyb3NlY29uZHMuICovXG4gICAgICAgICAgICBpbnRlcnZhbDogbnVtYmVyXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBzdGFydFByZWNpc2VDb3ZlcmFnZSA9IHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29sbGVjdCBhY2N1cmF0ZSBjYWxsIGNvdW50cyBiZXlvbmQgc2ltcGxlICdjb3ZlcmVkJyBvciAnbm90IGNvdmVyZWQnLlxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNhbGxDb3VudD86IGJvb2xlYW5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKioqKiBDb21tYW5kIFJlc3VsdCAqKioqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGV4cG9ydCBtb2R1bGUgUmVzdWx0IHtcbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgc3RvcCA9IHtcbiAgICAgICAgICAgIC8qKiBSZWNvcmRlZCBwcm9maWxlLiAqL1xuICAgICAgICAgICAgcHJvZmlsZTogUHJvZmlsZVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqIEBleHBlcmltZW50YWwgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgdGFrZVByZWNpc2VDb3ZlcmFnZSA9IHtcbiAgICAgICAgICAgIC8qKiBDb3ZlcmFnZSBkYXRhIGZvciB0aGUgY3VycmVudCBpc29sYXRlLiAqL1xuICAgICAgICAgICAgcmVzdWx0OiBTY3JpcHRDb3ZlcmFnZVtdXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBnZXRCZXN0RWZmb3J0Q292ZXJhZ2UgPSB7XG4gICAgICAgICAgICAvKiogQ292ZXJhZ2UgZGF0YSBmb3IgdGhlIGN1cnJlbnQgaXNvbGF0ZS4gKi9cbiAgICAgICAgICAgIHJlc3VsdDogU2NyaXB0Q292ZXJhZ2VbXVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICoqKiogRXZlbnQgUGFyYW1ldGVycyAqKioqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZXhwb3J0IG1vZHVsZSBFdmVudFBhcmFtcyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZW50IHdoZW4gbmV3IHByb2ZpbGUgcmVjb3JkaW5nIGlzIHN0YXJ0ZWQgdXNpbmcgY29uc29sZS5wcm9maWxlKCkgY2FsbC5cbiAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgKi9cbiAgICAgICAgZXhwb3J0IHR5cGUgY29uc29sZVByb2ZpbGVTdGFydGVkID0ge1xuICAgICAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgICAgICBpZDogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKiBMb2NhdGlvbiBvZiBjb25zb2xlLnByb2ZpbGUoKS4gKi9cbiAgICAgICAgICAgIGxvY2F0aW9uOiBEZWJ1Z2dlci5Mb2NhdGlvblxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFByb2ZpbGUgdGl0bGUgcGFzc2VkIGFzIGFuIGFyZ3VtZW50IHRvIGNvbnNvbGUucHJvZmlsZSgpLlxuICAgICAgICAgICAgICogQG9wdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRpdGxlPzogc3RyaW5nXG4gICAgICAgIH1cblxuICAgICAgICAvKiogQGV4cGVyaW1lbnRhbCAqL1xuICAgICAgICBleHBvcnQgdHlwZSBjb25zb2xlUHJvZmlsZUZpbmlzaGVkID0ge1xuICAgICAgICAgICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgICAgICAgICBpZDogc3RyaW5nXG5cbiAgICAgICAgICAgIC8qKiBMb2NhdGlvbiBvZiBjb25zb2xlLnByb2ZpbGVFbmQoKS4gKi9cbiAgICAgICAgICAgIGxvY2F0aW9uOiBEZWJ1Z2dlci5Mb2NhdGlvblxuXG4gICAgICAgICAgICAvKiogTm8gZGVzY3JpcHRpb24gKi9cbiAgICAgICAgICAgIHByb2ZpbGU6IFByb2ZpbGVcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBQcm9maWxlIHRpdGxlIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byBjb25zb2xlLnByb2ZpbGUoKS5cbiAgICAgICAgICAgICAqIEBvcHRpb25hbFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aXRsZT86IHN0cmluZ1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIE5vIGRlc2NyaXB0aW9uXG4gKi9cbmNsYXNzIFByb2ZpbGVyIHtcbiAgICBwcml2YXRlIGV2ZW50cyA9IG5ldyBFdmVudEVtaXR0ZXIoKVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBkYmc6IGFueSAvKiBFbGVjdHJvbi5EZWJ1Z2dlciovICkge1xuXG4gICAgICAgIHRoaXMuZGJnLm9uKCdtZXNzYWdlJywgKGV2ZW50OiBhbnksIG1ldGhvZDogYW55LCBwYXJhbXM6IGFueSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgW2RvbWFpbiwgZG9tYWluTWV0aG9kXSA9IG1ldGhvZC5zcGxpdCgnLicpXG4gICAgICAgICAgICB0aGlzLmV2ZW50cy5lbWl0KGRvbWFpbk1ldGhvZCwgcGFyYW1zKVxuICAgICAgICB9KVxuXG4gICAgICAgIGlmICghdGhpcy5kYmcuaXNBdHRhY2hlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBjcmVhdGUgUHJvZmlsZXIgRG9tYWluIENsYXNzIGJlY2F1c2UgdGhlIGRlYnVnZ2VyIGlzIG5vdCBhdHRhY2hlZC5gKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIG9uKGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbikge1xuICAgICAgICB0aGlzLmV2ZW50cy5vbihldmVudCwgbGlzdGVuZXIpXG4gICAgfVxuXG4gICAgcHVibGljIG9uY2UoZXZlbnQ6IHN0cmluZywgbGlzdGVuZXI6IEZ1bmN0aW9uKSB7XG4gICAgICAgIHRoaXMuZXZlbnRzLm9uKGV2ZW50LCBsaXN0ZW5lcilcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzc2VydEVycm9yKGVycm9yOiBhbnksIGNvbW1hbmROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCdtZXNzYWdlJyBpbiBlcnJvciAmJiAnY29kZScgaW4gZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBEZWJ1Z2dlckVycm9yKGVycm9yLm1lc3NhZ2UsIGVycm9yLmNvZGUsIGNvbW1hbmROYW1lKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIGVuYWJsZSgpOiBQcm9taXNlPHVuZGVmaW5lZD57XG4gICAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx1bmRlZmluZWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdQcm9maWxlci5lbmFibGUnLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1Byb2ZpbGVyLmVuYWJsZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIHB1YmxpYyBhc3luYyBkaXNhYmxlKCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1Byb2ZpbGVyLmRpc2FibGUnLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1Byb2ZpbGVyLmRpc2FibGUnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKiogQ2hhbmdlcyBDUFUgcHJvZmlsZXIgc2FtcGxpbmcgaW50ZXJ2YWwuIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBDUFUgcHJvZmlsZXMgcmVjb3JkaW5nIHN0YXJ0ZWQuICovXG4gICAgcHVibGljIGFzeW5jIHNldFNhbXBsaW5nSW50ZXJ2YWwocGFyYW1zOiBQcm9maWxlci5QYXJhbXMuc2V0U2FtcGxpbmdJbnRlcnZhbCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1Byb2ZpbGVyLnNldFNhbXBsaW5nSW50ZXJ2YWwnLCBwYXJhbXMsIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdQcm9maWxlci5zZXRTYW1wbGluZ0ludGVydmFsJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uICovXG4gICAgcHVibGljIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1Byb2ZpbGVyLnN0YXJ0Jywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdQcm9maWxlci5zdGFydCcpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKiBObyBkZXNjcmlwdGlvbiAqL1xuICAgIHB1YmxpYyBhc3luYyBzdG9wKCk6IFByb21pc2U8UHJvZmlsZXIuUmVzdWx0LnN0b3A+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8UHJvZmlsZXIuUmVzdWx0LnN0b3A+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGJnLnNlbmRDb21tYW5kKCdQcm9maWxlci5zdG9wJywge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdQcm9maWxlci5zdG9wJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCBhcyBQcm9maWxlci5SZXN1bHQuc3RvcClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHByZWNpc2UgY29kZSBjb3ZlcmFnZS4gQ292ZXJhZ2UgZGF0YSBmb3IgSmF2YVNjcmlwdCBleGVjdXRlZCBiZWZvcmUgZW5hYmxpbmcgcHJlY2lzZSBjb2RlIGNvdmVyYWdlIG1heSBiZSBpbmNvbXBsZXRlLiBFbmFibGluZyBwcmV2ZW50cyBydW5uaW5nIG9wdGltaXplZCBjb2RlIGFuZCByZXNldHMgZXhlY3V0aW9uIGNvdW50ZXJzLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgc3RhcnRQcmVjaXNlQ292ZXJhZ2UocGFyYW1zPzogUHJvZmlsZXIuUGFyYW1zLnN0YXJ0UHJlY2lzZUNvdmVyYWdlKTogUHJvbWlzZTx1bmRlZmluZWQ+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8dW5kZWZpbmVkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnUHJvZmlsZXIuc3RhcnRQcmVjaXNlQ292ZXJhZ2UnLCBwYXJhbXMgfHwge30sIChlcnJvcjogYW55LCByZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0RXJyb3IoZXJyb3IsICdQcm9maWxlci5zdGFydFByZWNpc2VDb3ZlcmFnZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc2FibGUgcHJlY2lzZSBjb2RlIGNvdmVyYWdlLiBEaXNhYmxpbmcgcmVsZWFzZXMgdW5uZWNlc3NhcnkgZXhlY3V0aW9uIGNvdW50IHJlY29yZHMgYW5kIGFsbG93cyBleGVjdXRpbmcgb3B0aW1pemVkIGNvZGUuXG4gICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBzdG9wUHJlY2lzZUNvdmVyYWdlKCk6IFByb21pc2U8dW5kZWZpbmVkPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1Byb2ZpbGVyLnN0b3BQcmVjaXNlQ292ZXJhZ2UnLCB7fSwgKGVycm9yOiBhbnksIHJlc3VsdDogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlcnRFcnJvcihlcnJvciwgJ1Byb2ZpbGVyLnN0b3BQcmVjaXNlQ292ZXJhZ2UnKVxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb2xsZWN0IGNvdmVyYWdlIGRhdGEgZm9yIHRoZSBjdXJyZW50IGlzb2xhdGUsIGFuZCByZXNldHMgZXhlY3V0aW9uIGNvdW50ZXJzLiBQcmVjaXNlIGNvZGUgY292ZXJhZ2UgbmVlZHMgdG8gaGF2ZSBzdGFydGVkLlxuICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgdGFrZVByZWNpc2VDb3ZlcmFnZSgpOiBQcm9taXNlPFByb2ZpbGVyLlJlc3VsdC50YWtlUHJlY2lzZUNvdmVyYWdlPntcbiAgICAgICAgcmV0dXJuIGF3YWl0IG5ldyBQcm9taXNlPFByb2ZpbGVyLlJlc3VsdC50YWtlUHJlY2lzZUNvdmVyYWdlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRiZy5zZW5kQ29tbWFuZCgnUHJvZmlsZXIudGFrZVByZWNpc2VDb3ZlcmFnZScsIHt9LCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnUHJvZmlsZXIudGFrZVByZWNpc2VDb3ZlcmFnZScpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQgYXMgUHJvZmlsZXIuUmVzdWx0LnRha2VQcmVjaXNlQ292ZXJhZ2UpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbGxlY3QgY292ZXJhZ2UgZGF0YSBmb3IgdGhlIGN1cnJlbnQgaXNvbGF0ZS4gVGhlIGNvdmVyYWdlIGRhdGEgbWF5IGJlIGluY29tcGxldGUgZHVlIHRvIGdhcmJhZ2UgY29sbGVjdGlvbi5cbiAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGdldEJlc3RFZmZvcnRDb3ZlcmFnZSgpOiBQcm9taXNlPFByb2ZpbGVyLlJlc3VsdC5nZXRCZXN0RWZmb3J0Q292ZXJhZ2U+e1xuICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2U8UHJvZmlsZXIuUmVzdWx0LmdldEJlc3RFZmZvcnRDb3ZlcmFnZT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYmcuc2VuZENvbW1hbmQoJ1Byb2ZpbGVyLmdldEJlc3RFZmZvcnRDb3ZlcmFnZScsIHt9LCAoZXJyb3I6IGFueSwgcmVzdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VydEVycm9yKGVycm9yLCAnUHJvZmlsZXIuZ2V0QmVzdEVmZm9ydENvdmVyYWdlJylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCBhcyBQcm9maWxlci5SZXN1bHQuZ2V0QmVzdEVmZm9ydENvdmVyYWdlKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgUHJvZmlsZXIiXX0=